<Application x:Class="TextFilter.App"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:Microsoft_Windows_Themes="clr-namespace:Microsoft.Windows.Themes;assembly=PresentationFramework.Aero"
             StartupUri="MainWindow.xaml">
    <Application.Resources>

        <!--  GroupBox  -->

        <ControlTemplate x:Key="GroupBoxControlTemplate1"
                         TargetType="{x:Type GroupBox}">
            <Grid SnapsToDevicePixels="True">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="6" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="6" />
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="6" />
                </Grid.RowDefinitions>
                <Border x:Name="Header"
                        Grid.Row="0"
                        Grid.RowSpan="2"
                        Grid.Column="1"
                        Padding="3,1,3,0">
                    <ContentPresenter Content="{TemplateBinding Header}"
                                      ContentSource="Header"
                                      ContentStringFormat="{TemplateBinding HeaderStringFormat}"
                                      ContentTemplate="{TemplateBinding HeaderTemplate}"
                                      RecognizesAccessKey="True"
                                      SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                </Border>
                <Border Grid.Row="1"
                        Grid.RowSpan="3"
                        Grid.ColumnSpan="4"
                        BorderBrush="White"
                        BorderThickness="{TemplateBinding BorderThickness}"
                        CornerRadius="4">
                    <Border.OpacityMask>
                        <MultiBinding ConverterParameter="7"
                                      UpdateSourceTrigger="Default">
                            <MultiBinding.Converter>
                                <BorderGapMaskConverter />
                            </MultiBinding.Converter>
                            <Binding ElementName="Header"
                                     Path="ActualWidth" />
                            <Binding Path="ActualWidth"
                                     RelativeSource="{RelativeSource Self}" />
                            <Binding Path="ActualHeight"
                                     RelativeSource="{RelativeSource Self}" />
                        </MultiBinding>
                    </Border.OpacityMask>
                    <Border BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="3">
                        <Border BorderBrush="White"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="2" />
                    </Border>
                </Border>
                <Border Grid.Row="1"
                        Grid.RowSpan="3"
                        Grid.Column="0"
                        Grid.ColumnSpan="4"
                        Background="{TemplateBinding Background}"
                        BorderBrush="Transparent"
                        BorderThickness="{TemplateBinding BorderThickness}"
                        CornerRadius="4" />
                <ContentPresenter Grid.Row="2"
                                  Grid.Column="1"
                                  Grid.ColumnSpan="2"
                                  Margin="{TemplateBinding Padding}"
                                  Content="{TemplateBinding Content}"
                                  ContentStringFormat="{TemplateBinding ContentStringFormat}"
                                  ContentTemplate="{TemplateBinding ContentTemplate}"
                                  SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
            </Grid>
        </ControlTemplate>

        <!--  Button  -->

        <Style x:Key="ButtonFocusVisual">
            <Setter Property="Control.Template">
                <Setter.Value>
                    <ControlTemplate>
                        <Rectangle Margin="2"
                                   SnapsToDevicePixels="true"
                                   Stroke="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                                   StrokeDashArray="1 2"
                                   StrokeThickness="1" />
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <LinearGradientBrush x:Key="ButtonNormalBackground"
                             StartPoint="0,0"
                             EndPoint="0,1">
            <GradientStop Offset="0"
                          Color="#F3F3F3" />
            <GradientStop Offset="0.5"
                          Color="#EBEBEB" />
            <GradientStop Offset="0.5"
                          Color="#DDDDDD" />
            <GradientStop Offset="1"
                          Color="#CDCDCD" />
        </LinearGradientBrush>
        <SolidColorBrush x:Key="ButtonNormalBorder"
                         Color="#FF707070" />
        <Style x:Key="ButtonStyle1"
               TargetType="{x:Type Button}">
            <Setter Property="FocusVisualStyle"
                    Value="{StaticResource ButtonFocusVisual}" />
            <Setter Property="Background"
                    Value="{StaticResource ButtonNormalBackground}" />
            <Setter Property="BorderBrush"
                    Value="{StaticResource ButtonNormalBorder}" />
            <Setter Property="BorderThickness"
                    Value="1" />
            <Setter Property="Foreground"
                    Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
            <Setter Property="HorizontalContentAlignment"
                    Value="Center" />
            <Setter Property="VerticalContentAlignment"
                    Value="Center" />
            <Setter Property="Padding"
                    Value="1" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Button}">
                        <Microsoft_Windows_Themes:ButtonChrome x:Name="Chrome"
                                                               Background="{TemplateBinding Background}"
                                                               BorderBrush="{TemplateBinding BorderBrush}"
                                                               RenderDefaulted="{TemplateBinding IsDefaulted}"
                                                               RenderMouseOver="{TemplateBinding IsMouseOver}"
                                                               RenderPressed="{TemplateBinding IsPressed}"
                                                               SnapsToDevicePixels="true">
                            <ContentPresenter Margin="{TemplateBinding Padding}"
                                              HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                              VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                              RecognizesAccessKey="True"
                                              SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                        </Microsoft_Windows_Themes:ButtonChrome>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsKeyboardFocused"
                                     Value="true">
                                <Setter TargetName="Chrome"
                                        Property="RenderDefaulted"
                                        Value="true" />
                            </Trigger>
                            <Trigger Property="ToggleButton.IsChecked"
                                     Value="true">
                                <Setter TargetName="Chrome"
                                        Property="RenderPressed"
                                        Value="true" />
                            </Trigger>
                            <Trigger Property="IsEnabled"
                                     Value="false">
                                <Setter Property="Foreground"
                                        Value="#ADADAD" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!--  CheckBox  -->

        <SolidColorBrush x:Key="CheckBoxFillNormal"
                         Color="#F4F4F4" />
        <SolidColorBrush x:Key="CheckBoxStroke"
                         Color="#8E8F8F" />
        <Style x:Key="EmptyCheckBoxFocusVisual">
            <Setter Property="Control.Template">
                <Setter.Value>
                    <ControlTemplate>
                        <Rectangle Margin="1"
                                   SnapsToDevicePixels="true"
                                   Stroke="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                                   StrokeDashArray="1 2"
                                   StrokeThickness="1" />
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="CheckRadioFocusVisual">
            <Setter Property="Control.Template">
                <Setter.Value>
                    <ControlTemplate>
                        <Rectangle Margin="14,0,0,0"
                                   SnapsToDevicePixels="true"
                                   Stroke="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                                   StrokeDashArray="1 2"
                                   StrokeThickness="1" />
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="CheckBoxStyle1"
               TargetType="{x:Type CheckBox}">
            <Setter Property="Foreground"
                    Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
            <Setter Property="Background"
                    Value="{StaticResource CheckBoxFillNormal}" />
            <Setter Property="BorderBrush"
                    Value="{StaticResource CheckBoxStroke}" />
            <Setter Property="BorderThickness"
                    Value="1" />
            <Setter Property="FocusVisualStyle"
                    Value="{StaticResource EmptyCheckBoxFocusVisual}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type CheckBox}">
                        <BulletDecorator Background="Transparent"
                                         SnapsToDevicePixels="true">
                            <BulletDecorator.Bullet>
                                <Microsoft_Windows_Themes:BulletChrome Background="{TemplateBinding Background}"
                                                                       BorderBrush="{TemplateBinding BorderBrush}"
                                                                       IsChecked="{TemplateBinding IsChecked}"
                                                                       RenderMouseOver="{TemplateBinding IsMouseOver}"
                                                                       RenderPressed="{TemplateBinding IsPressed}" />
                            </BulletDecorator.Bullet>
                            <ContentPresenter Margin="{TemplateBinding Padding}"
                                              HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                              VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                              RecognizesAccessKey="True"
                                              SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                        </BulletDecorator>
                        <ControlTemplate.Triggers>
                            <Trigger Property="HasContent"
                                     Value="true">
                                <Setter Property="FocusVisualStyle"
                                        Value="{StaticResource CheckRadioFocusVisual}" />
                                <Setter Property="Padding"
                                        Value="4,0,0,0" />
                            </Trigger>
                            <Trigger Property="IsEnabled"
                                     Value="false">
                                <Setter Property="Foreground"
                                        Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!--  RadioButton  -->

        <Style x:Key="RadioButtonStyle1"
               TargetType="{x:Type RadioButton}">
            <Setter Property="Foreground"
                    Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
            <Setter Property="Background"
                    Value="#F4F4F4" />
            <Setter Property="BorderBrush"
                    Value="{StaticResource CheckBoxStroke}" />
            <Setter Property="BorderThickness"
                    Value="1" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type RadioButton}">
                        <BulletDecorator Background="Transparent">
                            <BulletDecorator.Bullet>
                                <Microsoft_Windows_Themes:BulletChrome Background="{TemplateBinding Background}"
                                                                       BorderBrush="{TemplateBinding BorderBrush}"
                                                                       IsChecked="{TemplateBinding IsChecked}"
                                                                       IsRound="true"
                                                                       RenderMouseOver="{TemplateBinding IsMouseOver}"
                                                                       RenderPressed="{TemplateBinding IsPressed}" />
                            </BulletDecorator.Bullet>
                            <ContentPresenter Margin="{TemplateBinding Padding}"
                                              HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                              VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                              RecognizesAccessKey="True" />
                        </BulletDecorator>
                        <ControlTemplate.Triggers>
                            <Trigger Property="HasContent"
                                     Value="true">
                                <Setter Property="FocusVisualStyle"
                                        Value="{StaticResource CheckRadioFocusVisual}" />
                                <Setter Property="Padding"
                                        Value="4,0,0,0" />
                            </Trigger>
                            <Trigger Property="IsEnabled"
                                     Value="false">
                                <Setter Property="Foreground"
                                        Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!--  TextBox  -->

        <LinearGradientBrush x:Key="TextBoxBorder"
                             MappingMode="Absolute"
                             StartPoint="0,0"
                             EndPoint="0,20">
            <GradientStop Offset="0.05"
                          Color="#ABADB3" />
            <GradientStop Offset="0.07"
                          Color="#E2E3EA" />
            <GradientStop Offset="1"
                          Color="#E3E9EF" />
        </LinearGradientBrush>
        <Style x:Key="TextBoxStyle1"
               BasedOn="{x:Null}"
               TargetType="{x:Type TextBox}">
            <Setter Property="Foreground"
                    Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
            <Setter Property="Background"
                    Value="{DynamicResource {x:Static SystemColors.WindowBrushKey}}" />
            <Setter Property="BorderBrush"
                    Value="{StaticResource TextBoxBorder}" />
            <Setter Property="BorderThickness"
                    Value="1" />
            <Setter Property="Padding"
                    Value="1" />
            <Setter Property="AllowDrop"
                    Value="true" />
            <Setter Property="FocusVisualStyle"
                    Value="{x:Null}" />
            <Setter Property="ScrollViewer.PanningMode"
                    Value="VerticalFirst" />
            <Setter Property="Stylus.IsFlicksEnabled"
                    Value="False" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type TextBox}">
                        <Microsoft_Windows_Themes:ListBoxChrome x:Name="Bd"
                                                                Background="{TemplateBinding Background}"
                                                                BorderBrush="{TemplateBinding BorderBrush}"
                                                                BorderThickness="{TemplateBinding BorderThickness}"
                                                                RenderFocused="{TemplateBinding IsKeyboardFocusWithin}"
                                                                RenderMouseOver="{TemplateBinding IsMouseOver}"
                                                                SnapsToDevicePixels="true">
                            <ScrollViewer x:Name="PART_ContentHost"
                                          SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                        </Microsoft_Windows_Themes:ListBoxChrome>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsEnabled"
                                     Value="false">
                                <Setter TargetName="Bd"
                                        Property="Background"
                                        Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" />
                                <Setter Property="Foreground"
                                        Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="{x:Type TextBoxBase}"
               BasedOn="{x:Null}"
               TargetType="{x:Type TextBoxBase}">
            <Setter Property="Foreground"
                    Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
            <Setter Property="Background"
                    Value="{DynamicResource {x:Static SystemColors.WindowBrushKey}}" />
            <Setter Property="BorderBrush"
                    Value="{StaticResource TextBoxBorder}" />
            <Setter Property="BorderThickness"
                    Value="1" />
            <Setter Property="Padding"
                    Value="1" />
            <Setter Property="AllowDrop"
                    Value="true" />
            <Setter Property="FocusVisualStyle"
                    Value="{x:Null}" />
            <Setter Property="ScrollViewer.PanningMode"
                    Value="VerticalFirst" />
            <Setter Property="Stylus.IsFlicksEnabled"
                    Value="False" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type TextBoxBase}">
                        <Microsoft_Windows_Themes:ListBoxChrome x:Name="Bd"
                                                                Background="{TemplateBinding Background}"
                                                                BorderBrush="{TemplateBinding BorderBrush}"
                                                                BorderThickness="{TemplateBinding BorderThickness}"
                                                                RenderFocused="{TemplateBinding IsKeyboardFocusWithin}"
                                                                RenderMouseOver="{TemplateBinding IsMouseOver}"
                                                                SnapsToDevicePixels="true">
                            <ScrollViewer x:Name="PART_ContentHost"
                                          SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                        </Microsoft_Windows_Themes:ListBoxChrome>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsEnabled"
                                     Value="false">
                                <Setter TargetName="Bd"
                                        Property="Background"
                                        Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" />
                                <Setter Property="Foreground"
                                        Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!--  RichTextBox  -->

        <Style x:Key="{x:Type Hyperlink}"
               TargetType="{x:Type Hyperlink}">
            <Setter Property="Foreground"
                    Value="Blue" />
            <Setter Property="TextDecorations"
                    Value="Underline" />
            <Style.Triggers>
                <Trigger Property="IsMouseOver"
                         Value="true">
                    <Setter Property="Foreground"
                            Value="Red" />
                </Trigger>
                <Trigger Property="IsEnabled"
                         Value="false">
                    <Setter Property="Foreground"
                            Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                </Trigger>
                <Trigger Property="IsEnabled"
                         Value="true">
                    <Setter Property="Cursor"
                            Value="Hand" />
                </Trigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="RichTextBoxStyle1"
               TargetType="{x:Type RichTextBox}">
            <Style.Resources>
                <Style x:Key="{x:Type FlowDocument}"
                       TargetType="{x:Type FlowDocument}">
                    <Setter Property="OverridesDefaultStyle"
                            Value="true" />
                </Style>
                <Style x:Key="{x:Type Hyperlink}"
                       BasedOn="{StaticResource {x:Type Hyperlink}}"
                       TargetType="{x:Type Hyperlink}">
                    <Style.Triggers>
                        <Trigger Property="IsMouseOver"
                                 Value="true">
                            <Setter Property="Foreground"
                                    Value="Blue" />
                        </Trigger>
                        <Trigger Property="IsEnabled"
                                 Value="false">
                            <Setter Property="Foreground"
                                    Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </Style.Resources>
            <Setter Property="MinWidth"
                    Value="10" />
            <Style.BasedOn>
                <StaticResource ResourceKey="{x:Type TextBoxBase}" />
            </Style.BasedOn>
        </Style>

        <!--  Label  -->

        <Style x:Key="LabelStyle1"
               TargetType="{x:Type Label}">
            <Setter Property="Foreground"
                    Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
            <Setter Property="Background"
                    Value="Transparent" />
            <Setter Property="Padding"
                    Value="5" />
            <Setter Property="HorizontalContentAlignment"
                    Value="Left" />
            <Setter Property="VerticalContentAlignment"
                    Value="Top" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Label}">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                Padding="{TemplateBinding Padding}"
                                SnapsToDevicePixels="true">
                            <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                              VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                              RecognizesAccessKey="True"
                                              SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsEnabled"
                                     Value="false">
                                <Setter Property="Foreground"
                                        Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!--  ScrollBar  -->

        <LinearGradientBrush x:Key="VerticalScrollBarBackground"
                             StartPoint="0,0"
                             EndPoint="1,0">
            <GradientStop Offset="0"
                          Color="#E1E1E1" />
            <GradientStop Offset="0.20"
                          Color="#EDEDED" />
            <GradientStop Offset="0.80"
                          Color="#EDEDED" />
            <GradientStop Offset="1"
                          Color="#E3E3E3" />
        </LinearGradientBrush>
        <SolidColorBrush x:Key="ScrollBarDisabledBackground"
                         Color="#F4F4F4" />
        <Style x:Key="ScrollBarButton"
               TargetType="{x:Type RepeatButton}">
            <Setter Property="OverridesDefaultStyle"
                    Value="true" />
            <Setter Property="Focusable"
                    Value="false" />
            <Setter Property="IsTabStop"
                    Value="false" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type RepeatButton}">
                        <Microsoft_Windows_Themes:ScrollChrome x:Name="Chrome"
                                                               Microsoft_Windows_Themes:ScrollChrome.ScrollGlyph="{TemplateBinding Microsoft_Windows_Themes:ScrollChrome.ScrollGlyph}"
                                                               RenderMouseOver="{TemplateBinding IsMouseOver}"
                                                               RenderPressed="{TemplateBinding IsPressed}"
                                                               SnapsToDevicePixels="true" />
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="VerticalScrollBarPageButton"
               TargetType="{x:Type RepeatButton}">
            <Setter Property="OverridesDefaultStyle"
                    Value="true" />
            <Setter Property="Background"
                    Value="Transparent" />
            <Setter Property="Focusable"
                    Value="false" />
            <Setter Property="IsTabStop"
                    Value="false" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type RepeatButton}">
                        <Rectangle Width="{TemplateBinding Width}"
                                   Height="{TemplateBinding Height}"
                                   Fill="{TemplateBinding Background}" />
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="ScrollBarThumb"
               TargetType="{x:Type Thumb}">
            <Setter Property="OverridesDefaultStyle"
                    Value="true" />
            <Setter Property="IsTabStop"
                    Value="false" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Thumb}">
                        <Microsoft_Windows_Themes:ScrollChrome x:Name="Chrome"
                                                               Microsoft_Windows_Themes:ScrollChrome.ScrollGlyph="{TemplateBinding Microsoft_Windows_Themes:ScrollChrome.ScrollGlyph}"
                                                               RenderMouseOver="{TemplateBinding IsMouseOver}"
                                                               RenderPressed="{TemplateBinding IsDragging}"
                                                               SnapsToDevicePixels="true" />
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <LinearGradientBrush x:Key="HorizontalScrollBarBackground"
                             StartPoint="0,0"
                             EndPoint="0,1">
            <GradientStop Offset="0"
                          Color="#E1E1E1" />
            <GradientStop Offset="0.20"
                          Color="#EDEDED" />
            <GradientStop Offset="0.80"
                          Color="#EDEDED" />
            <GradientStop Offset="1"
                          Color="#E3E3E3" />
        </LinearGradientBrush>
        <Style x:Key="HorizontalScrollBarPageButton"
               TargetType="{x:Type RepeatButton}">
            <Setter Property="OverridesDefaultStyle"
                    Value="true" />
            <Setter Property="Background"
                    Value="Transparent" />
            <Setter Property="Focusable"
                    Value="false" />
            <Setter Property="IsTabStop"
                    Value="false" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type RepeatButton}">
                        <Rectangle Width="{TemplateBinding Width}"
                                   Height="{TemplateBinding Height}"
                                   Fill="{TemplateBinding Background}" />
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="ScrollBarStyle1"
               TargetType="{x:Type ScrollBar}">
            <Setter Property="Background"
                    Value="{StaticResource VerticalScrollBarBackground}" />
            <Setter Property="Stylus.IsPressAndHoldEnabled"
                    Value="false" />
            <Setter Property="Stylus.IsFlicksEnabled"
                    Value="false" />
            <Setter Property="Foreground"
                    Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
            <Setter Property="Width"
                    Value="{DynamicResource {x:Static SystemParameters.VerticalScrollBarWidthKey}}" />
            <Setter Property="MinWidth"
                    Value="{DynamicResource {x:Static SystemParameters.VerticalScrollBarWidthKey}}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ScrollBar}">
                        <Grid x:Name="Bg"
                              Background="{TemplateBinding Background}"
                              SnapsToDevicePixels="true">
                            <Grid.RowDefinitions>
                                <RowDefinition MaxHeight="{DynamicResource {x:Static SystemParameters.VerticalScrollBarButtonHeightKey}}" />
                                <RowDefinition Height="0.00001*" />
                                <RowDefinition MaxHeight="{DynamicResource {x:Static SystemParameters.VerticalScrollBarButtonHeightKey}}" />
                            </Grid.RowDefinitions>
                            <RepeatButton Microsoft_Windows_Themes:ScrollChrome.ScrollGlyph="UpArrow"
                                          Command="{x:Static ScrollBar.LineUpCommand}"
                                          IsEnabled="{TemplateBinding IsMouseOver}"
                                          Style="{StaticResource ScrollBarButton}" />
                            <Track x:Name="PART_Track"
                                   Grid.Row="1"
                                   IsDirectionReversed="true"
                                   IsEnabled="{TemplateBinding IsMouseOver}">
                                <Track.DecreaseRepeatButton>
                                    <RepeatButton Command="{x:Static ScrollBar.PageUpCommand}"
                                                  Style="{StaticResource VerticalScrollBarPageButton}" />
                                </Track.DecreaseRepeatButton>
                                <Track.IncreaseRepeatButton>
                                    <RepeatButton Command="{x:Static ScrollBar.PageDownCommand}"
                                                  Style="{StaticResource VerticalScrollBarPageButton}" />
                                </Track.IncreaseRepeatButton>
                                <Track.Thumb>
                                    <Thumb Microsoft_Windows_Themes:ScrollChrome.ScrollGlyph="VerticalGripper"
                                           Style="{StaticResource ScrollBarThumb}" />
                                </Track.Thumb>
                            </Track>
                            <RepeatButton Grid.Row="2"
                                          Microsoft_Windows_Themes:ScrollChrome.ScrollGlyph="DownArrow"
                                          Command="{x:Static ScrollBar.LineDownCommand}"
                                          IsEnabled="{TemplateBinding IsMouseOver}"
                                          Style="{StaticResource ScrollBarButton}" />
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsEnabled"
                                     Value="false">
                                <Setter TargetName="Bg"
                                        Property="Background"
                                        Value="{StaticResource ScrollBarDisabledBackground}" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="Orientation"
                         Value="Horizontal">
                    <Setter Property="Width"
                            Value="Auto" />
                    <Setter Property="MinWidth"
                            Value="0" />
                    <Setter Property="Height"
                            Value="{DynamicResource {x:Static SystemParameters.HorizontalScrollBarHeightKey}}" />
                    <Setter Property="MinHeight"
                            Value="{DynamicResource {x:Static SystemParameters.HorizontalScrollBarHeightKey}}" />
                    <Setter Property="Background"
                            Value="{StaticResource HorizontalScrollBarBackground}" />
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="{x:Type ScrollBar}">
                                <Grid x:Name="Bg"
                                      Background="{TemplateBinding Background}"
                                      SnapsToDevicePixels="true">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition MaxWidth="{DynamicResource {x:Static SystemParameters.HorizontalScrollBarButtonWidthKey}}" />
                                        <ColumnDefinition Width="0.00001*" />
                                        <ColumnDefinition MaxWidth="{DynamicResource {x:Static SystemParameters.HorizontalScrollBarButtonWidthKey}}" />
                                    </Grid.ColumnDefinitions>
                                    <RepeatButton Microsoft_Windows_Themes:ScrollChrome.ScrollGlyph="LeftArrow"
                                                  Command="{x:Static ScrollBar.LineLeftCommand}"
                                                  IsEnabled="{TemplateBinding IsMouseOver}"
                                                  Style="{StaticResource ScrollBarButton}" />
                                    <Track x:Name="PART_Track"
                                           Grid.Column="1"
                                           IsEnabled="{TemplateBinding IsMouseOver}">
                                        <Track.DecreaseRepeatButton>
                                            <RepeatButton Command="{x:Static ScrollBar.PageLeftCommand}"
                                                          Style="{StaticResource HorizontalScrollBarPageButton}" />
                                        </Track.DecreaseRepeatButton>
                                        <Track.IncreaseRepeatButton>
                                            <RepeatButton Command="{x:Static ScrollBar.PageRightCommand}"
                                                          Style="{StaticResource HorizontalScrollBarPageButton}" />
                                        </Track.IncreaseRepeatButton>
                                        <Track.Thumb>
                                            <Thumb Microsoft_Windows_Themes:ScrollChrome.ScrollGlyph="HorizontalGripper"
                                                   Style="{StaticResource ScrollBarThumb}" />
                                        </Track.Thumb>
                                    </Track>
                                    <RepeatButton Grid.Column="2"
                                                  Microsoft_Windows_Themes:ScrollChrome.ScrollGlyph="RightArrow"
                                                  Command="{x:Static ScrollBar.LineRightCommand}"
                                                  IsEnabled="{TemplateBinding IsMouseOver}"
                                                  Style="{StaticResource ScrollBarButton}" />
                                </Grid>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsEnabled"
                                             Value="false">
                                        <Setter TargetName="Bg"
                                                Property="Background"
                                                Value="{StaticResource ScrollBarDisabledBackground}" />
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!--  Slider  -->

        <LinearGradientBrush x:Key="HorizontalSliderThumbHoverBackgroundInverted"
                             StartPoint="0,1"
                             EndPoint="0,0">
            <GradientStop Offset="0"
                          Color="white" />
            <GradientStop Offset="0.5"
                          Color="#B8E2F9" />
            <GradientStop Offset="1"
                          Color="#B0DFF8" />
        </LinearGradientBrush>
        <SolidColorBrush x:Key="HorizontalSliderThumbHoverBorder"
                         Color="#3C7FB1" />
        <LinearGradientBrush x:Key="HorizontalSliderThumbPressedBackgroundInverted"
                             StartPoint="0,1"
                             EndPoint="0,0">
            <GradientStop Offset="0.25"
                          Color="#B8E4FA" />
            <GradientStop Offset="0.5"
                          Color="#5EB4E3" />
            <GradientStop Offset="1"
                          Color="#4C8BB4" />
        </LinearGradientBrush>
        <SolidColorBrush x:Key="HorizontalSliderThumbPressedBorder"
                         Color="#2C628B" />
        <Geometry x:Key="SliderThumbDisabledGeometry">M -5,-10.5 L 5,-10.5 L 5,10.5 L -5,10.5 Z</Geometry>
        <Geometry x:Key="SliderPointedThumbDisabledGeometry">M 4.5,-8.5 L -4.5,-8.5 L -4.5,4.5 L -0.5,8.5 L 0.5,8.5 L 4.5,4.5 Z</Geometry>
        <Geometry x:Key="SliderPointedThumbOuterBorderGeometry">M 4.5,-7.5 A 1 1 0 0 0 3.5,-8.5 L -3.5,-8.5 A 1 1 0 0 0 -4.5,-7.5 L -4.5,4.5 L -0.5,8.5 L 0.5,8.5 L 4.5,4.5 Z</Geometry>
        <LinearGradientBrush x:Key="HorizontalSliderThumbNormalBackgroundInverted"
                             StartPoint="0,1"
                             EndPoint="0,0">
            <GradientStop Offset="0"
                          Color="White" />
            <GradientStop Offset="0.4"
                          Color="#F0EFEF" />
            <GradientStop Offset=".8"
                          Color="#D6D5D5" />
        </LinearGradientBrush>
        <Geometry x:Key="SliderPointedThumbMiddleBorderGeometry">M 3.5,-7.5 L -3.5,-7.5 L -3.5,4.5 L 0,8 L 3.5,4.5 Z</Geometry>
        <Style x:Key="HorizontalSliderUpThumbStyle"
               TargetType="{x:Type Thumb}">
            <Setter Property="Focusable"
                    Value="false" />
            <Setter Property="OverridesDefaultStyle"
                    Value="true" />
            <Setter Property="Height"
                    Value="18" />
            <Setter Property="Width"
                    Value="10" />
            <Setter Property="Foreground"
                    Value="Gray" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Thumb}">
                        <Canvas SnapsToDevicePixels="true">
                            <Canvas.RenderTransform>
                                <TransformGroup>
                                    <TransformGroup.Children>
                                        <TransformCollection>
                                            <RotateTransform Angle="180" />
                                            <TranslateTransform X="5"
                                                                Y="9" />
                                        </TransformCollection>
                                    </TransformGroup.Children>
                                </TransformGroup>
                            </Canvas.RenderTransform>
                            <Path x:Name="Background"
                                  Data="{StaticResource SliderPointedThumbOuterBorderGeometry}"
                                  Fill="{StaticResource HorizontalSliderThumbNormalBackgroundInverted}" />
                            <Path x:Name="InnerBorder"
                                  Data="{StaticResource SliderPointedThumbMiddleBorderGeometry}"
                                  Stroke="White"
                                  StrokeThickness="1" />
                            <Path x:Name="OuterBorder"
                                  Data="{StaticResource SliderPointedThumbOuterBorderGeometry}"
                                  Stroke="#FF929292"
                                  StrokeThickness="1" />
                        </Canvas>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver"
                                     Value="true">
                                <Setter TargetName="Background"
                                        Property="Fill"
                                        Value="{StaticResource HorizontalSliderThumbHoverBackgroundInverted}" />
                                <Setter TargetName="OuterBorder"
                                        Property="Stroke"
                                        Value="{StaticResource HorizontalSliderThumbHoverBorder}" />
                            </Trigger>
                            <Trigger Property="Foreground"
                                     Value="Blue">
                                <Setter TargetName="Background"
                                        Property="Fill"
                                        Value="{StaticResource HorizontalSliderThumbHoverBackgroundInverted}" />
                                <Setter TargetName="OuterBorder"
                                        Property="Stroke"
                                        Value="{StaticResource HorizontalSliderThumbHoverBorder}" />
                            </Trigger>
                            <Trigger Property="IsDragging"
                                     Value="true">
                                <Setter TargetName="Background"
                                        Property="Fill"
                                        Value="{StaticResource HorizontalSliderThumbPressedBackgroundInverted}" />
                                <Setter TargetName="OuterBorder"
                                        Property="Stroke"
                                        Value="{StaticResource HorizontalSliderThumbPressedBorder}" />
                            </Trigger>
                            <Trigger Property="IsEnabled"
                                     Value="false">
                                <Setter TargetName="Background"
                                        Property="Fill"
                                        Value="#FFF4F4F4" />
                                <Setter TargetName="InnerBorder"
                                        Property="Stroke"
                                        Value="{x:Null}" />
                                <Setter TargetName="OuterBorder"
                                        Property="Data"
                                        Value="{StaticResource SliderThumbDisabledGeometry}" />
                                <Setter TargetName="OuterBorder"
                                        Property="Stroke"
                                        Value="#FFAEB1AF" />
                                <Setter TargetName="OuterBorder"
                                        Property="Data"
                                        Value="{StaticResource SliderPointedThumbDisabledGeometry}" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <LinearGradientBrush x:Key="HorizontalSliderThumbHoverBackground"
                             StartPoint="0,0"
                             EndPoint="0,1">
            <GradientStop Offset="0"
                          Color="white" />
            <GradientStop Offset="0.5"
                          Color="#B8E2F9" />
            <GradientStop Offset="1"
                          Color="#B0DFF8" />
        </LinearGradientBrush>
        <LinearGradientBrush x:Key="HorizontalSliderThumbPressedBackground"
                             StartPoint="0,0"
                             EndPoint="0,1">
            <GradientStop Offset="0.25"
                          Color="#B8E4FA" />
            <GradientStop Offset="0.5"
                          Color="#5EB4E3" />
            <GradientStop Offset="1"
                          Color="#4C8BB4" />
        </LinearGradientBrush>
        <LinearGradientBrush x:Key="HorizontalSliderThumbNormalBackground"
                             StartPoint="0,0"
                             EndPoint="0,1">
            <GradientStop Offset="0"
                          Color="White" />
            <GradientStop Offset="0.4"
                          Color="#F0EFEF" />
            <GradientStop Offset=".8"
                          Color="#D6D5D5" />
        </LinearGradientBrush>
        <Style x:Key="HorizontalSliderDownThumbStyle"
               TargetType="{x:Type Thumb}">
            <Setter Property="Focusable"
                    Value="false" />
            <Setter Property="OverridesDefaultStyle"
                    Value="true" />
            <Setter Property="Height"
                    Value="18" />
            <Setter Property="Width"
                    Value="10" />
            <Setter Property="Foreground"
                    Value="Gray" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Thumb}">
                        <Canvas SnapsToDevicePixels="true">
                            <Canvas.RenderTransform>
                                <TranslateTransform X="5"
                                                    Y="9" />
                            </Canvas.RenderTransform>
                            <Path x:Name="Background"
                                  Data="{StaticResource SliderPointedThumbOuterBorderGeometry}"
                                  Fill="{StaticResource HorizontalSliderThumbNormalBackground}" />
                            <Path x:Name="InnerBorder"
                                  Data="{StaticResource SliderPointedThumbMiddleBorderGeometry}"
                                  Stroke="White"
                                  StrokeThickness="1" />
                            <Path x:Name="OuterBorder"
                                  Data="{StaticResource SliderPointedThumbOuterBorderGeometry}"
                                  Stroke="#FF929292"
                                  StrokeThickness="1" />
                        </Canvas>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver"
                                     Value="true">
                                <Setter TargetName="Background"
                                        Property="Fill"
                                        Value="{StaticResource HorizontalSliderThumbHoverBackground}" />
                                <Setter TargetName="OuterBorder"
                                        Property="Stroke"
                                        Value="{StaticResource HorizontalSliderThumbHoverBorder}" />
                            </Trigger>
                            <Trigger Property="Foreground"
                                     Value="Blue">
                                <Setter TargetName="Background"
                                        Property="Fill"
                                        Value="{StaticResource HorizontalSliderThumbHoverBackground}" />
                                <Setter TargetName="OuterBorder"
                                        Property="Stroke"
                                        Value="{StaticResource HorizontalSliderThumbHoverBorder}" />
                            </Trigger>
                            <Trigger Property="IsDragging"
                                     Value="true">
                                <Setter TargetName="Background"
                                        Property="Fill"
                                        Value="{StaticResource HorizontalSliderThumbPressedBackground}" />
                                <Setter TargetName="OuterBorder"
                                        Property="Stroke"
                                        Value="{StaticResource HorizontalSliderThumbPressedBorder}" />
                            </Trigger>
                            <Trigger Property="IsEnabled"
                                     Value="false">
                                <Setter TargetName="Background"
                                        Property="Fill"
                                        Value="#FFF4F4F4" />
                                <Setter TargetName="InnerBorder"
                                        Property="Stroke"
                                        Value="{x:Null}" />
                                <Setter TargetName="OuterBorder"
                                        Property="Data"
                                        Value="{StaticResource SliderThumbDisabledGeometry}" />
                                <Setter TargetName="OuterBorder"
                                        Property="Stroke"
                                        Value="#FFAEB1AF" />
                                <Setter TargetName="OuterBorder"
                                        Property="Data"
                                        Value="{StaticResource SliderPointedThumbDisabledGeometry}" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <LinearGradientBrush x:Key="HorizontalSliderTrackNormalBorder"
                             StartPoint="0,0"
                             EndPoint="0,1">
            <GradientStop Offset="0.1"
                          Color="#FFAEB1AF" />
            <GradientStop Offset=".9"
                          Color="White" />
        </LinearGradientBrush>
        <SolidColorBrush x:Key="HorizontalSliderTrackNormalBackground"
                         Color="#FFE7EAEA" />
        <Style x:Key="SliderRepeatButtonStyle"
               TargetType="{x:Type RepeatButton}">
            <Setter Property="OverridesDefaultStyle"
                    Value="true" />
            <Setter Property="IsTabStop"
                    Value="false" />
            <Setter Property="Focusable"
                    Value="false" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type RepeatButton}">
                        <Rectangle Fill="Transparent" />
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Geometry x:Key="SliderThumbOuterBorderGeometry">M -5,-9.5 A 1 1 0 0 1 -4,-10.5 L 4,-10.5 A 1 1 0 0 1 5,-9.5 L 5,9.5 A 1 1 0 0 1 4,10.5 L -4,10.5 A 1 1 0 0 1 -5,9.5 Z</Geometry>
        <Geometry x:Key="SliderThumbMiddleBorderGeometry">M -4,-9.5 L 4,-9.5 L 4,9.5 L -4,9.5 Z</Geometry>
        <Style x:Key="HorizontalSliderThumbStyle"
               TargetType="{x:Type Thumb}">
            <Setter Property="Focusable"
                    Value="false" />
            <Setter Property="OverridesDefaultStyle"
                    Value="true" />
            <Setter Property="Height"
                    Value="22" />
            <Setter Property="Width"
                    Value="11" />
            <Setter Property="Foreground"
                    Value="Gray" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Thumb}">
                        <Canvas SnapsToDevicePixels="true">
                            <Canvas.RenderTransform>
                                <TranslateTransform X="5.5"
                                                    Y="11" />
                            </Canvas.RenderTransform>
                            <Path x:Name="Background"
                                  Data="{StaticResource SliderThumbOuterBorderGeometry}"
                                  Fill="{StaticResource HorizontalSliderThumbNormalBackground}" />
                            <Path x:Name="InnerBorder"
                                  Data="{StaticResource SliderThumbMiddleBorderGeometry}"
                                  Stroke="White" />
                            <Path x:Name="OuterBorder"
                                  Data="{StaticResource SliderThumbOuterBorderGeometry}"
                                  Stroke="#FF929292" />
                        </Canvas>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver"
                                     Value="true">
                                <Setter TargetName="Background"
                                        Property="Fill"
                                        Value="{StaticResource HorizontalSliderThumbHoverBackground}" />
                                <Setter TargetName="OuterBorder"
                                        Property="Stroke"
                                        Value="{StaticResource HorizontalSliderThumbHoverBorder}" />
                            </Trigger>
                            <Trigger Property="Foreground"
                                     Value="Blue">
                                <Setter TargetName="Background"
                                        Property="Fill"
                                        Value="{StaticResource HorizontalSliderThumbHoverBackground}" />
                                <Setter TargetName="OuterBorder"
                                        Property="Stroke"
                                        Value="{StaticResource HorizontalSliderThumbHoverBorder}" />
                            </Trigger>
                            <Trigger Property="IsDragging"
                                     Value="true">
                                <Setter TargetName="Background"
                                        Property="Fill"
                                        Value="{StaticResource HorizontalSliderThumbPressedBackground}" />
                                <Setter TargetName="OuterBorder"
                                        Property="Stroke"
                                        Value="{StaticResource HorizontalSliderThumbPressedBorder}" />
                            </Trigger>
                            <Trigger Property="IsEnabled"
                                     Value="false">
                                <Setter TargetName="Background"
                                        Property="Fill"
                                        Value="#FFF4F4F4" />
                                <Setter TargetName="InnerBorder"
                                        Property="Stroke"
                                        Value="{x:Null}" />
                                <Setter TargetName="OuterBorder"
                                        Property="Data"
                                        Value="{StaticResource SliderThumbDisabledGeometry}" />
                                <Setter TargetName="OuterBorder"
                                        Property="Stroke"
                                        Value="#FFAEB1AF" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <LinearGradientBrush x:Key="VerticalSliderThumbHoverBackground"
                             StartPoint="0,0"
                             EndPoint="1,0">
            <GradientStop Offset="0"
                          Color="white" />
            <GradientStop Offset="0.5"
                          Color="#B8E2F9" />
            <GradientStop Offset="1"
                          Color="#B0DFF8" />
        </LinearGradientBrush>
        <LinearGradientBrush x:Key="VerticalSliderThumbPressedBackground"
                             StartPoint="0,0"
                             EndPoint="1,0">
            <GradientStop Offset="0.25"
                          Color="#B8E4FA" />
            <GradientStop Offset="0.5"
                          Color="#5EB4E3" />
            <GradientStop Offset="1"
                          Color="#4C8BB4" />
        </LinearGradientBrush>
        <LinearGradientBrush x:Key="VerticalSliderThumbNormalBackground"
                             StartPoint="0,0"
                             EndPoint="1,0">
            <GradientStop Offset="0"
                          Color="White" />
            <GradientStop Offset="0.4"
                          Color="#F0EFEF" />
            <GradientStop Offset=".8"
                          Color="#D6D5D5" />
        </LinearGradientBrush>
        <Style x:Key="VerticalSliderLeftThumbStyle"
               TargetType="{x:Type Thumb}">
            <Setter Property="Focusable"
                    Value="false" />
            <Setter Property="OverridesDefaultStyle"
                    Value="true" />
            <Setter Property="Height"
                    Value="10" />
            <Setter Property="Width"
                    Value="18" />
            <Setter Property="Foreground"
                    Value="Gray" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Thumb}">
                        <Canvas SnapsToDevicePixels="true">
                            <Canvas.RenderTransform>
                                <TransformGroup>
                                    <TransformGroup.Children>
                                        <TransformCollection>
                                            <RotateTransform Angle="90" />
                                            <TranslateTransform X="9"
                                                                Y="5" />
                                        </TransformCollection>
                                    </TransformGroup.Children>
                                </TransformGroup>
                            </Canvas.RenderTransform>
                            <Path x:Name="Background"
                                  Data="{StaticResource SliderPointedThumbOuterBorderGeometry}"
                                  Fill="{StaticResource VerticalSliderThumbNormalBackground}" />
                            <Path x:Name="InnerBorder"
                                  Data="{StaticResource SliderPointedThumbMiddleBorderGeometry}"
                                  Stroke="White"
                                  StrokeThickness="1" />
                            <Path x:Name="OuterBorder"
                                  Data="{StaticResource SliderPointedThumbOuterBorderGeometry}"
                                  Stroke="#FF929292"
                                  StrokeThickness="1" />
                        </Canvas>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver"
                                     Value="true">
                                <Setter TargetName="Background"
                                        Property="Fill"
                                        Value="{StaticResource VerticalSliderThumbHoverBackground}" />
                                <Setter TargetName="OuterBorder"
                                        Property="Stroke"
                                        Value="{StaticResource HorizontalSliderThumbHoverBorder}" />
                            </Trigger>
                            <Trigger Property="Foreground"
                                     Value="Blue">
                                <Setter TargetName="Background"
                                        Property="Fill"
                                        Value="{StaticResource VerticalSliderThumbHoverBackground}" />
                                <Setter TargetName="OuterBorder"
                                        Property="Stroke"
                                        Value="{StaticResource HorizontalSliderThumbHoverBorder}" />
                            </Trigger>
                            <Trigger Property="IsDragging"
                                     Value="true">
                                <Setter TargetName="Background"
                                        Property="Fill"
                                        Value="{StaticResource VerticalSliderThumbPressedBackground}" />
                                <Setter TargetName="OuterBorder"
                                        Property="Stroke"
                                        Value="{StaticResource HorizontalSliderThumbPressedBorder}" />
                            </Trigger>
                            <Trigger Property="IsEnabled"
                                     Value="false">
                                <Setter TargetName="Background"
                                        Property="Fill"
                                        Value="#FFF4F4F4" />
                                <Setter TargetName="InnerBorder"
                                        Property="Stroke"
                                        Value="{x:Null}" />
                                <Setter TargetName="OuterBorder"
                                        Property="Data"
                                        Value="{StaticResource SliderPointedThumbDisabledGeometry}" />
                                <Setter TargetName="OuterBorder"
                                        Property="Stroke"
                                        Value="#FFAEB1AF" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <LinearGradientBrush x:Key="VerticalSliderThumbHoverBackgroundInverted"
                             StartPoint="1,0"
                             EndPoint="0,0">
            <GradientStop Offset="0"
                          Color="white" />
            <GradientStop Offset="0.5"
                          Color="#B8E2F9" />
            <GradientStop Offset="1"
                          Color="#B0DFF8" />
        </LinearGradientBrush>
        <LinearGradientBrush x:Key="VerticalSliderThumbPressedBackgroundInverted"
                             StartPoint="1,0"
                             EndPoint="0,0">
            <GradientStop Offset="0.25"
                          Color="#B8E4FA" />
            <GradientStop Offset="0.5"
                          Color="#5EB4E3" />
            <GradientStop Offset="1"
                          Color="#4C8BB4" />
        </LinearGradientBrush>
        <LinearGradientBrush x:Key="VerticalSliderThumbNormalBackgroundInverted"
                             StartPoint="1,0"
                             EndPoint="0,0">
            <GradientStop Offset="0"
                          Color="White" />
            <GradientStop Offset="0.4"
                          Color="#F0EFEF" />
            <GradientStop Offset=".8"
                          Color="#D6D5D5" />
        </LinearGradientBrush>
        <Style x:Key="VerticalSliderRightThumbStyle"
               TargetType="{x:Type Thumb}">
            <Setter Property="Focusable"
                    Value="false" />
            <Setter Property="OverridesDefaultStyle"
                    Value="true" />
            <Setter Property="Height"
                    Value="10" />
            <Setter Property="Width"
                    Value="18" />
            <Setter Property="Foreground"
                    Value="Gray" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Thumb}">
                        <Canvas SnapsToDevicePixels="true">
                            <Canvas.RenderTransform>
                                <TransformGroup>
                                    <TransformGroup.Children>
                                        <TransformCollection>
                                            <RotateTransform Angle="-90" />
                                            <TranslateTransform X="9"
                                                                Y="5" />
                                        </TransformCollection>
                                    </TransformGroup.Children>
                                </TransformGroup>
                            </Canvas.RenderTransform>
                            <Path x:Name="Background"
                                  Data="{StaticResource SliderPointedThumbOuterBorderGeometry}"
                                  Fill="{StaticResource VerticalSliderThumbNormalBackgroundInverted}" />
                            <Path x:Name="InnerBorder"
                                  Data="{StaticResource SliderPointedThumbMiddleBorderGeometry}"
                                  Stroke="White"
                                  StrokeThickness="1" />
                            <Path x:Name="OuterBorder"
                                  Data="{StaticResource SliderPointedThumbOuterBorderGeometry}"
                                  Stroke="#FF929292"
                                  StrokeThickness="1" />
                        </Canvas>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver"
                                     Value="true">
                                <Setter TargetName="Background"
                                        Property="Fill"
                                        Value="{StaticResource VerticalSliderThumbHoverBackgroundInverted}" />
                                <Setter TargetName="OuterBorder"
                                        Property="Stroke"
                                        Value="{StaticResource HorizontalSliderThumbHoverBorder}" />
                            </Trigger>
                            <Trigger Property="Foreground"
                                     Value="Blue">
                                <Setter TargetName="Background"
                                        Property="Fill"
                                        Value="{StaticResource VerticalSliderThumbHoverBackgroundInverted}" />
                                <Setter TargetName="OuterBorder"
                                        Property="Stroke"
                                        Value="{StaticResource HorizontalSliderThumbHoverBorder}" />
                            </Trigger>
                            <Trigger Property="IsDragging"
                                     Value="true">
                                <Setter TargetName="Background"
                                        Property="Fill"
                                        Value="{StaticResource VerticalSliderThumbPressedBackgroundInverted}" />
                                <Setter TargetName="OuterBorder"
                                        Property="Stroke"
                                        Value="{StaticResource HorizontalSliderThumbPressedBorder}" />
                            </Trigger>
                            <Trigger Property="IsEnabled"
                                     Value="false">
                                <Setter TargetName="Background"
                                        Property="Fill"
                                        Value="#FFF4F4F4" />
                                <Setter TargetName="InnerBorder"
                                        Property="Stroke"
                                        Value="{x:Null}" />
                                <Setter TargetName="OuterBorder"
                                        Property="Data"
                                        Value="{StaticResource SliderPointedThumbDisabledGeometry}" />
                                <Setter TargetName="OuterBorder"
                                        Property="Stroke"
                                        Value="#FFAEB1AF" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <LinearGradientBrush x:Key="VerticalSliderTrackNormalBorder"
                             StartPoint="0,0"
                             EndPoint="1,0">
            <GradientStop Offset="0.1"
                          Color="#FFAEB1AF" />
            <GradientStop Offset=".9"
                          Color="White" />
        </LinearGradientBrush>
        <Style x:Key="VerticalSliderThumbStyle"
               TargetType="{x:Type Thumb}">
            <Setter Property="Focusable"
                    Value="false" />
            <Setter Property="OverridesDefaultStyle"
                    Value="true" />
            <Setter Property="Height"
                    Value="11" />
            <Setter Property="Width"
                    Value="22" />
            <Setter Property="Foreground"
                    Value="Gray" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Thumb}">
                        <Canvas SnapsToDevicePixels="true">
                            <Canvas.RenderTransform>
                                <TransformGroup>
                                    <TransformGroup.Children>
                                        <TransformCollection>
                                            <RotateTransform Angle="90" />
                                            <TranslateTransform X="11"
                                                                Y="5.5" />
                                        </TransformCollection>
                                    </TransformGroup.Children>
                                </TransformGroup>
                            </Canvas.RenderTransform>
                            <Path x:Name="Background"
                                  Data="{StaticResource SliderThumbOuterBorderGeometry}"
                                  Fill="{StaticResource VerticalSliderThumbNormalBackground}" />
                            <Path x:Name="InnerBorder"
                                  Data="{StaticResource SliderThumbMiddleBorderGeometry}"
                                  Stroke="White"
                                  StrokeThickness="1" />
                            <Path x:Name="OuterBorder"
                                  Data="{StaticResource SliderThumbOuterBorderGeometry}"
                                  Stroke="#FF929292"
                                  StrokeThickness="1" />
                        </Canvas>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver"
                                     Value="true">
                                <Setter TargetName="Background"
                                        Property="Fill"
                                        Value="{StaticResource VerticalSliderThumbHoverBackground}" />
                                <Setter TargetName="OuterBorder"
                                        Property="Stroke"
                                        Value="{StaticResource HorizontalSliderThumbHoverBorder}" />
                            </Trigger>
                            <Trigger Property="Foreground"
                                     Value="Blue">
                                <Setter TargetName="Background"
                                        Property="Fill"
                                        Value="{StaticResource VerticalSliderThumbHoverBackground}" />
                                <Setter TargetName="OuterBorder"
                                        Property="Stroke"
                                        Value="{StaticResource HorizontalSliderThumbHoverBorder}" />
                            </Trigger>
                            <Trigger Property="IsDragging"
                                     Value="true">
                                <Setter TargetName="Background"
                                        Property="Fill"
                                        Value="{StaticResource VerticalSliderThumbPressedBackground}" />
                                <Setter TargetName="OuterBorder"
                                        Property="Stroke"
                                        Value="{StaticResource HorizontalSliderThumbPressedBorder}" />
                            </Trigger>
                            <Trigger Property="IsEnabled"
                                     Value="false">
                                <Setter TargetName="Background"
                                        Property="Fill"
                                        Value="#FFF4F4F4" />
                                <Setter TargetName="InnerBorder"
                                        Property="Stroke"
                                        Value="{x:Null}" />
                                <Setter TargetName="OuterBorder"
                                        Property="Data"
                                        Value="{StaticResource SliderThumbDisabledGeometry}" />
                                <Setter TargetName="OuterBorder"
                                        Property="Stroke"
                                        Value="#FFAEB1AF" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="SliderStyle1"
               TargetType="{x:Type Slider}">
            <Setter Property="Stylus.IsPressAndHoldEnabled"
                    Value="false" />
            <Setter Property="Background"
                    Value="Transparent" />
            <Setter Property="Foreground"
                    Value="#FFC4C4C4" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Slider}">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                SnapsToDevicePixels="true">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto"
                                                   MinHeight="{TemplateBinding MinHeight}" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <TickBar x:Name="TopTick"
                                         Grid.Row="0"
                                         Height="4"
                                         Fill="{TemplateBinding Foreground}"
                                         Placement="Top"
                                         Visibility="Collapsed" />
                                <Border x:Name="TrackBackground"
                                        Grid.Row="1"
                                        Height="4.0"
                                        Margin="5,0"
                                        VerticalAlignment="center"
                                        Background="{StaticResource HorizontalSliderTrackNormalBackground}"
                                        BorderBrush="{StaticResource HorizontalSliderTrackNormalBorder}"
                                        BorderThickness="1"
                                        CornerRadius="1">
                                    <Canvas Margin="-6,-1">
                                        <Rectangle x:Name="PART_SelectionRange"
                                                   Height="4.0"
                                                   Fill="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}"
                                                   Stroke="{DynamicResource {x:Static SystemColors.ControlDarkDarkBrushKey}}"
                                                   StrokeThickness="1.0"
                                                   Visibility="Hidden" />
                                    </Canvas>
                                </Border>
                                <Track x:Name="PART_Track"
                                       Grid.Row="1">
                                    <Track.DecreaseRepeatButton>
                                        <RepeatButton Command="{x:Static Slider.DecreaseLarge}"
                                                      Style="{StaticResource SliderRepeatButtonStyle}" />
                                    </Track.DecreaseRepeatButton>
                                    <Track.IncreaseRepeatButton>
                                        <RepeatButton Command="{x:Static Slider.IncreaseLarge}"
                                                      Style="{StaticResource SliderRepeatButtonStyle}" />
                                    </Track.IncreaseRepeatButton>
                                    <Track.Thumb>
                                        <Thumb x:Name="Thumb"
                                               Style="{StaticResource HorizontalSliderThumbStyle}" />
                                    </Track.Thumb>
                                </Track>
                                <TickBar x:Name="BottomTick"
                                         Grid.Row="2"
                                         Height="4"
                                         Fill="{TemplateBinding Foreground}"
                                         Placement="Bottom"
                                         Visibility="Collapsed" />
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="TickPlacement"
                                     Value="TopLeft">
                                <Setter TargetName="TopTick"
                                        Property="Visibility"
                                        Value="Visible" />
                                <Setter TargetName="Thumb"
                                        Property="Style"
                                        Value="{StaticResource HorizontalSliderUpThumbStyle}" />
                                <Setter TargetName="TrackBackground"
                                        Property="Margin"
                                        Value="5,2,5,0" />
                            </Trigger>
                            <Trigger Property="TickPlacement"
                                     Value="BottomRight">
                                <Setter TargetName="BottomTick"
                                        Property="Visibility"
                                        Value="Visible" />
                                <Setter TargetName="Thumb"
                                        Property="Style"
                                        Value="{StaticResource HorizontalSliderDownThumbStyle}" />
                                <Setter TargetName="TrackBackground"
                                        Property="Margin"
                                        Value="5,0,5,2" />
                            </Trigger>
                            <Trigger Property="TickPlacement"
                                     Value="Both">
                                <Setter TargetName="TopTick"
                                        Property="Visibility"
                                        Value="Visible" />
                                <Setter TargetName="BottomTick"
                                        Property="Visibility"
                                        Value="Visible" />
                            </Trigger>
                            <Trigger Property="IsSelectionRangeEnabled"
                                     Value="true">
                                <Setter TargetName="PART_SelectionRange"
                                        Property="Visibility"
                                        Value="Visible" />
                            </Trigger>
                            <Trigger Property="IsKeyboardFocused"
                                     Value="true">
                                <Setter TargetName="Thumb"
                                        Property="Foreground"
                                        Value="Blue" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="Orientation"
                         Value="Vertical">
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="{x:Type Slider}">
                                <Border Background="{TemplateBinding Background}"
                                        BorderBrush="{TemplateBinding BorderBrush}"
                                        BorderThickness="{TemplateBinding BorderThickness}"
                                        SnapsToDevicePixels="true">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto"
                                                              MinWidth="{TemplateBinding MinWidth}" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <TickBar x:Name="TopTick"
                                                 Grid.Column="0"
                                                 Width="4"
                                                 Fill="{TemplateBinding Foreground}"
                                                 Placement="Left"
                                                 Visibility="Collapsed" />
                                        <Border x:Name="TrackBackground"
                                                Grid.Column="1"
                                                Width="4.0"
                                                Margin="0,5"
                                                HorizontalAlignment="center"
                                                Background="{StaticResource HorizontalSliderTrackNormalBackground}"
                                                BorderBrush="{StaticResource VerticalSliderTrackNormalBorder}"
                                                BorderThickness="1"
                                                CornerRadius="1">
                                            <Canvas Margin="-1,-6">
                                                <Rectangle x:Name="PART_SelectionRange"
                                                           Width="4.0"
                                                           Fill="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}"
                                                           Stroke="{DynamicResource {x:Static SystemColors.ControlDarkDarkBrushKey}}"
                                                           StrokeThickness="1.0"
                                                           Visibility="Hidden" />
                                            </Canvas>
                                        </Border>
                                        <Track x:Name="PART_Track"
                                               Grid.Column="1">
                                            <Track.DecreaseRepeatButton>
                                                <RepeatButton Command="{x:Static Slider.DecreaseLarge}"
                                                              Style="{StaticResource SliderRepeatButtonStyle}" />
                                            </Track.DecreaseRepeatButton>
                                            <Track.IncreaseRepeatButton>
                                                <RepeatButton Command="{x:Static Slider.IncreaseLarge}"
                                                              Style="{StaticResource SliderRepeatButtonStyle}" />
                                            </Track.IncreaseRepeatButton>
                                            <Track.Thumb>
                                                <Thumb x:Name="Thumb"
                                                       Style="{StaticResource VerticalSliderThumbStyle}" />
                                            </Track.Thumb>
                                        </Track>
                                        <TickBar x:Name="BottomTick"
                                                 Grid.Column="2"
                                                 Width="4"
                                                 Fill="{TemplateBinding Foreground}"
                                                 Placement="Right"
                                                 Visibility="Collapsed" />
                                    </Grid>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="TickPlacement"
                                             Value="TopLeft">
                                        <Setter TargetName="TopTick"
                                                Property="Visibility"
                                                Value="Visible" />
                                        <Setter TargetName="Thumb"
                                                Property="Style"
                                                Value="{StaticResource VerticalSliderLeftThumbStyle}" />
                                        <Setter TargetName="TrackBackground"
                                                Property="Margin"
                                                Value="2,5,0,5" />
                                    </Trigger>
                                    <Trigger Property="TickPlacement"
                                             Value="BottomRight">
                                        <Setter TargetName="BottomTick"
                                                Property="Visibility"
                                                Value="Visible" />
                                        <Setter TargetName="Thumb"
                                                Property="Style"
                                                Value="{StaticResource VerticalSliderRightThumbStyle}" />
                                        <Setter TargetName="TrackBackground"
                                                Property="Margin"
                                                Value="0,5,2,5" />
                                    </Trigger>
                                    <Trigger Property="TickPlacement"
                                             Value="Both">
                                        <Setter TargetName="TopTick"
                                                Property="Visibility"
                                                Value="Visible" />
                                        <Setter TargetName="BottomTick"
                                                Property="Visibility"
                                                Value="Visible" />
                                    </Trigger>
                                    <Trigger Property="IsSelectionRangeEnabled"
                                             Value="true">
                                        <Setter TargetName="PART_SelectionRange"
                                                Property="Visibility"
                                                Value="Visible" />
                                    </Trigger>
                                    <Trigger Property="IsKeyboardFocused"
                                             Value="true">
                                        <Setter TargetName="Thumb"
                                                Property="Foreground"
                                                Value="Blue" />
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!--  Menu  -->

        <LinearGradientBrush x:Key="MenuBackground"
                             StartPoint="0,0"
                             EndPoint="0,1">
            <GradientStop Offset="0.25"
                          Color="#F6F6F6" />
            <GradientStop Offset="0.25"
                          Color="#EAE8E8" />
            <GradientStop Offset="0.8"
                          Color="#DCD9D9" />
            <GradientStop Offset="1"
                          Color="White" />
        </LinearGradientBrush>
        <Style x:Key="MenuStyle1"
               TargetType="{x:Type Menu}">
            <Setter Property="Background"
                    Value="{StaticResource MenuBackground}" />
            <Setter Property="FontFamily"
                    Value="{DynamicResource {x:Static SystemFonts.MenuFontFamilyKey}}" />
            <Setter Property="FontSize"
                    Value="{DynamicResource {x:Static SystemFonts.MenuFontSizeKey}}" />
            <Setter Property="FontStyle"
                    Value="{DynamicResource {x:Static SystemFonts.MenuFontStyleKey}}" />
            <Setter Property="FontWeight"
                    Value="{DynamicResource {x:Static SystemFonts.MenuFontWeightKey}}" />
            <Setter Property="Foreground"
                    Value="{DynamicResource {x:Static SystemColors.MenuTextBrushKey}}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Menu}">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                Padding="{TemplateBinding Padding}"
                                SnapsToDevicePixels="true">
                            <ItemsPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <LinearGradientBrush x:Key="MenuItemSelectionFill"
                             StartPoint="0,0"
                             EndPoint="0,1">
            <GradientStop Offset="0"
                          Color="#34C5EBFF" />
            <GradientStop Offset="1"
                          Color="#3481D8FF" />
        </LinearGradientBrush>
        <Geometry x:Key="Checkmark">M 0,5.1 L 1.7,5.2 L 3.4,7.1 L 8,0.4 L 9.2,0 L 3.3,10.8 Z</Geometry>
        <ControlTemplate x:Key="{ComponentResourceKey ResourceId=SubmenuItemTemplateKey, TypeInTargetAssembly={x:Type MenuItem}}"
                         TargetType="{x:Type MenuItem}">
            <Grid SnapsToDevicePixels="true">
                <Rectangle x:Name="Bg"
                           Fill="{TemplateBinding Background}"
                           Stroke="{TemplateBinding BorderBrush}"
                           StrokeThickness="0"
                           Margin="-1" />
                <Rectangle x:Name="InnerBorder"
                           Margin="-1" />
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"
                                          MinWidth="24"
                                          SharedSizeGroup="MenuItemIconColumnGroup" />
                        <ColumnDefinition Width="4" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="37" />
                        <ColumnDefinition Width="Auto"
                                          SharedSizeGroup="MenuItemIGTColumnGroup" />
                        <ColumnDefinition Width="17" />
                    </Grid.ColumnDefinitions>
                    <ContentPresenter x:Name="Icon"
                                      Margin="1"
                                      VerticalAlignment="Center"
                                      ContentSource="Icon"
                                      SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                    <Border x:Name="GlyphPanel"
                            Width="22"
                            Height="22"
                            Margin="1"
                            Background="#E6EFF4"
                            BorderBrush="#CDD3E6"
                            BorderThickness="1"
                            CornerRadius="3"
                            Visibility="Hidden">
                        <Path x:Name="Glyph"
                              Width="9"
                              Height="11"
                              Data="{StaticResource Checkmark}"
                              Fill="#0C12A1"
                              FlowDirection="LeftToRight" />
                    </Border>
                    <ContentPresenter Grid.Column="2"
                                      Margin="{TemplateBinding Padding}"
                                      ContentSource="Header"
                                      RecognizesAccessKey="True"
                                      SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                    <TextBlock Grid.Column="4"
                               Margin="{TemplateBinding Padding}"
                               Text="{TemplateBinding InputGestureText}" />
                </Grid>
            </Grid>
            <ControlTemplate.Triggers>
                <Trigger Property="Icon"
                         Value="{x:Null}">
                    <Setter TargetName="Icon"
                            Property="Visibility"
                            Value="Collapsed" />
                </Trigger>
                <Trigger Property="IsChecked"
                         Value="true">
                    <Setter TargetName="GlyphPanel"
                            Property="Visibility"
                            Value="Visible" />
                    <Setter TargetName="Icon"
                            Property="Visibility"
                            Value="Collapsed" />
                </Trigger>
                <Trigger Property="IsHighlighted"
                         Value="true">
                    <Setter TargetName="Bg"
                            Property="Fill"
                            Value="{StaticResource MenuItemSelectionFill}" />
                    <Setter TargetName="Bg"
                            Property="Stroke"
                            Value="#8071CBF1" />
                    <Setter TargetName="InnerBorder"
                            Property="Stroke"
                            Value="#40FFFFFF" />
                </Trigger>
                <Trigger Property="IsEnabled"
                         Value="false">
                    <Setter Property="Foreground"
                            Value="#FF9A9A9A" />
                    <Setter TargetName="GlyphPanel"
                            Property="Background"
                            Value="#EEE9E9" />
                    <Setter TargetName="GlyphPanel"
                            Property="BorderBrush"
                            Value="#DBD6D6" />
                    <Setter TargetName="Glyph"
                            Property="Fill"
                            Value="#848589" />
                </Trigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>
        <LinearGradientBrush x:Key="MenuItemPressedFill"
                             StartPoint="0,0"
                             EndPoint="0,1">
            <GradientStop Offset="0"
                          Color="#28717070" />
            <GradientStop Offset="0.75"
                          Color="#50717070" />
            <GradientStop Offset="1"
                          Color="#90717070" />
        </LinearGradientBrush>
        <SolidColorBrush x:Key="SubMenuBackgroundBrush"
                         Color="#FFF5F5F5" />
        <Geometry x:Key="UpArrow">M 0,4 L 3.5,0 L 7,4 Z</Geometry>
        <Style x:Key="MenuScrollButton"
               BasedOn="{x:Null}"
               TargetType="{x:Type RepeatButton}">
            <Setter Property="ClickMode"
                    Value="Hover" />
            <Setter Property="MinWidth"
                    Value="0" />
            <Setter Property="MinHeight"
                    Value="0" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type RepeatButton}">
                        <DockPanel Background="Transparent"
                                   SnapsToDevicePixels="true">
                            <Rectangle x:Name="R1"
                                       Width="1"
                                       DockPanel.Dock="Right"
                                       Fill="Transparent" />
                            <Rectangle x:Name="B1"
                                       Height="1"
                                       DockPanel.Dock="Bottom"
                                       Fill="Transparent" />
                            <Rectangle x:Name="L1"
                                       Width="1"
                                       DockPanel.Dock="Left"
                                       Fill="Transparent" />
                            <Rectangle x:Name="T1"
                                       Height="1"
                                       DockPanel.Dock="Top"
                                       Fill="Transparent" />
                            <ContentPresenter x:Name="ContentContainer"
                                              Margin="2,2,2,2"
                                              HorizontalAlignment="Center"
                                              VerticalAlignment="Center" />
                        </DockPanel>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsPressed"
                                     Value="true">
                                <Setter TargetName="R1"
                                        Property="Fill"
                                        Value="{DynamicResource {x:Static SystemColors.ControlLightLightBrushKey}}" />
                                <Setter TargetName="B1"
                                        Property="Fill"
                                        Value="{DynamicResource {x:Static SystemColors.ControlLightLightBrushKey}}" />
                                <Setter TargetName="L1"
                                        Property="Fill"
                                        Value="{DynamicResource {x:Static SystemColors.ControlDarkDarkBrushKey}}" />
                                <Setter TargetName="T1"
                                        Property="Fill"
                                        Value="{DynamicResource {x:Static SystemColors.ControlDarkDarkBrushKey}}" />
                                <Setter TargetName="ContentContainer"
                                        Property="Margin"
                                        Value="3,3,1,1" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <MenuScrollingVisibilityConverter x:Key="MenuScrollingVisibilityConverter" />
        <Geometry x:Key="DownArrow">M 0,0 L 3.5,4 L 7,0 Z</Geometry>
        <Style x:Key="{ComponentResourceKey ResourceId=MenuScrollViewer,
                                            TypeInTargetAssembly={x:Type FrameworkElement}}"
               BasedOn="{x:Null}"
               TargetType="{x:Type ScrollViewer}">
            <Setter Property="HorizontalScrollBarVisibility"
                    Value="Hidden" />
            <Setter Property="VerticalScrollBarVisibility"
                    Value="Auto" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ScrollViewer}">
                        <Grid SnapsToDevicePixels="true">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <RepeatButton Grid.Row="0"
                                          Grid.Column="0"
                                          Command="{x:Static ScrollBar.LineUpCommand}"
                                          CommandTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}"
                                          Focusable="false"
                                          Style="{StaticResource MenuScrollButton}">
                                <RepeatButton.Visibility>
                                    <MultiBinding Converter="{StaticResource MenuScrollingVisibilityConverter}"
                                                  ConverterParameter="0"
                                                  FallbackValue="Visibility.Collapsed">
                                        <Binding Path="ComputedVerticalScrollBarVisibility"
                                                 RelativeSource="{RelativeSource TemplatedParent}" />
                                        <Binding Path="VerticalOffset"
                                                 RelativeSource="{RelativeSource TemplatedParent}" />
                                        <Binding Path="ExtentHeight"
                                                 RelativeSource="{RelativeSource TemplatedParent}" />
                                        <Binding Path="ViewportHeight"
                                                 RelativeSource="{RelativeSource TemplatedParent}" />
                                    </MultiBinding>
                                </RepeatButton.Visibility>
                                <Path Data="{StaticResource UpArrow}"
                                      Fill="{DynamicResource {x:Static SystemColors.MenuTextBrushKey}}" />
                            </RepeatButton>
                            <Border Grid.Row="1"
                                    Grid.Column="0">
                                <ScrollContentPresenter Margin="{TemplateBinding Padding}" />
                            </Border>
                            <RepeatButton Grid.Row="2"
                                          Grid.Column="0"
                                          Command="{x:Static ScrollBar.LineDownCommand}"
                                          CommandTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}"
                                          Focusable="false"
                                          Style="{StaticResource MenuScrollButton}">
                                <RepeatButton.Visibility>
                                    <MultiBinding Converter="{StaticResource MenuScrollingVisibilityConverter}"
                                                  ConverterParameter="100"
                                                  FallbackValue="Visibility.Collapsed">
                                        <Binding Path="ComputedVerticalScrollBarVisibility"
                                                 RelativeSource="{RelativeSource TemplatedParent}" />
                                        <Binding Path="VerticalOffset"
                                                 RelativeSource="{RelativeSource TemplatedParent}" />
                                        <Binding Path="ExtentHeight"
                                                 RelativeSource="{RelativeSource TemplatedParent}" />
                                        <Binding Path="ViewportHeight"
                                                 RelativeSource="{RelativeSource TemplatedParent}" />
                                    </MultiBinding>
                                </RepeatButton.Visibility>
                                <Path Data="{StaticResource DownArrow}"
                                      Fill="{DynamicResource {x:Static SystemColors.MenuTextBrushKey}}" />
                            </RepeatButton>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <ControlTemplate x:Key="{ComponentResourceKey ResourceId=SubmenuContent, TypeInTargetAssembly={x:Type FrameworkElement}}"
                         TargetType="{x:Type ContentControl}">
            <Border Background="{StaticResource SubMenuBackgroundBrush}"
                    BorderBrush="#FF959595"
                    BorderThickness="1">
                <Grid>
                    <Rectangle Width="28"
                               Margin="2"
                               HorizontalAlignment="Left"
                               Fill="#F1F1F1"
                               RadiusX="2"
                               RadiusY="2" />
                    <Rectangle Width="1"
                               Margin="30,2,0,2"
                               HorizontalAlignment="Left"
                               Fill="#E2E3E3" />
                    <Rectangle Width="1"
                               Margin="31,2,0,2"
                               HorizontalAlignment="Left"
                               Fill="White" />
                    <ContentPresenter Grid.ColumnSpan="2"
                                      Margin="1,0" />
                </Grid>
            </Border>
        </ControlTemplate>
        <ControlTemplate x:Key="{ComponentResourceKey ResourceId=TopLevelHeaderTemplateKey, TypeInTargetAssembly={x:Type MenuItem}}"
                         TargetType="{x:Type MenuItem}">
            <Grid SnapsToDevicePixels="true">
                <Rectangle x:Name="OuterBorder"
                           RadiusX="2"
                           RadiusY="2" />
                <Rectangle x:Name="Bg"
                           Margin="1"
                           Fill="{TemplateBinding Background}"
                           RadiusX="1"
                           RadiusY="1"
                           Stroke="{TemplateBinding BorderBrush}"
                           StrokeThickness="1" />
                <Rectangle x:Name="InnerBorder"
                           Margin="2" />
                <DockPanel>
                    <ContentPresenter x:Name="Icon"
                                      Margin="4,0,6,0"
                                      VerticalAlignment="Center"
                                      ContentSource="Icon"
                                      SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                    <Path x:Name="GlyphPanel"
                          Margin="7,0,0,0"
                          VerticalAlignment="Center"
                          Data="{StaticResource Checkmark}"
                          Fill="{TemplateBinding Foreground}"
                          FlowDirection="LeftToRight"
                          Visibility="Collapsed" />
                    <ContentPresenter Margin="{TemplateBinding Padding}"
                                      ContentSource="Header"
                                      RecognizesAccessKey="True"
                                      SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                </DockPanel>
                <Popup x:Name="PART_Popup"
                       AllowsTransparency="true"
                       Focusable="false"
                       HorizontalOffset="1"
                       IsOpen="{Binding IsSubmenuOpen,
                                        RelativeSource={RelativeSource TemplatedParent}}"
                       Placement="Bottom"
                       PopupAnimation="{DynamicResource {x:Static SystemParameters.MenuPopupAnimationKey}}"
                       VerticalOffset="-1">
                    <Microsoft_Windows_Themes:SystemDropShadowChrome x:Name="Shdw"
                                                                     Color="Transparent">
                        <ContentControl x:Name="SubMenuBorder"
                                        IsTabStop="false"
                                        Template="{DynamicResource {ComponentResourceKey ResourceId=SubmenuContent,
                                                                                         TypeInTargetAssembly={x:Type FrameworkElement}}}">
                            <ScrollViewer x:Name="SubMenuScrollViewer"
                                          CanContentScroll="true"
                                          Style="{DynamicResource {ComponentResourceKey ResourceId=MenuScrollViewer,
                                                                                        TypeInTargetAssembly={x:Type FrameworkElement}}}">
                                <Grid RenderOptions.ClearTypeHint="Enabled">
                                    <Canvas Width="0"
                                            Height="0"
                                            HorizontalAlignment="Left"
                                            VerticalAlignment="Top">
                                        <Rectangle Width="{Binding ActualWidth,
                                                                   ElementName=SubMenuBorder}"
                                                   Height="{Binding ActualHeight,
                                                                    ElementName=SubMenuBorder}"
                                                   Fill="{StaticResource SubMenuBackgroundBrush}" />
                                    </Canvas>
                                    <ItemsPresenter x:Name="ItemsPresenter"
                                                    Margin="-1"
                                                    Grid.IsSharedSizeScope="true"
                                                    KeyboardNavigation.DirectionalNavigation="Cycle"
                                                    KeyboardNavigation.TabNavigation="Cycle"
                                                    SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                                </Grid>
                            </ScrollViewer>
                        </ContentControl>
                    </Microsoft_Windows_Themes:SystemDropShadowChrome>
                </Popup>
            </Grid>
            <ControlTemplate.Triggers>
                <Trigger Property="IsSuspendingPopupAnimation"
                         Value="true">
                    <Setter TargetName="PART_Popup"
                            Property="PopupAnimation"
                            Value="None" />
                </Trigger>
                <Trigger Property="Icon"
                         Value="{x:Null}">
                    <Setter TargetName="Icon"
                            Property="Visibility"
                            Value="Collapsed" />
                </Trigger>
                <Trigger Property="IsChecked"
                         Value="true">
                    <Setter TargetName="GlyphPanel"
                            Property="Visibility"
                            Value="Visible" />
                    <Setter TargetName="Icon"
                            Property="Visibility"
                            Value="Collapsed" />
                </Trigger>
                <Trigger SourceName="PART_Popup"
                         Property="HasDropShadow"
                         Value="true">
                    <Setter TargetName="Shdw"
                            Property="Margin"
                            Value="0,0,5,5" />
                    <Setter TargetName="Shdw"
                            Property="Color"
                            Value="#71000000" />
                </Trigger>
                <Trigger Property="IsHighlighted"
                         Value="true">
                    <Setter TargetName="Bg"
                            Property="Stroke"
                            Value="#90717070" />
                    <Setter TargetName="OuterBorder"
                            Property="Stroke"
                            Value="#50FFFFFF" />
                    <Setter TargetName="InnerBorder"
                            Property="Stroke"
                            Value="#50FFFFFF" />
                </Trigger>
                <Trigger Property="IsKeyboardFocused"
                         Value="true">
                    <Setter TargetName="Bg"
                            Property="Stroke"
                            Value="#E0717070" />
                    <Setter TargetName="Bg"
                            Property="Fill"
                            Value="{StaticResource MenuItemPressedFill}" />
                    <Setter TargetName="InnerBorder"
                            Property="Stroke"
                            Value="#50747272" />
                </Trigger>
                <Trigger Property="IsSubmenuOpen"
                         Value="true">
                    <Setter TargetName="Bg"
                            Property="Stroke"
                            Value="#E0717070" />
                    <Setter TargetName="Bg"
                            Property="Fill"
                            Value="{StaticResource MenuItemPressedFill}" />
                    <Setter TargetName="InnerBorder"
                            Property="Stroke"
                            Value="#50747272" />
                </Trigger>
                <Trigger Property="IsEnabled"
                         Value="false">
                    <Setter Property="Foreground"
                            Value="#FF9A9A9A" />
                    <Setter TargetName="GlyphPanel"
                            Property="Fill"
                            Value="#848589" />
                </Trigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>
        <ControlTemplate x:Key="{ComponentResourceKey ResourceId=TopLevelItemTemplateKey, TypeInTargetAssembly={x:Type MenuItem}}"
                         TargetType="{x:Type MenuItem}">
            <Grid SnapsToDevicePixels="true">
                <Rectangle x:Name="OuterBorder"
                           RadiusX="2"
                           RadiusY="2" />
                <Rectangle x:Name="Bg"
                           Margin="1"
                           Fill="{TemplateBinding Background}"
                           RadiusX="1"
                           RadiusY="1"
                           Stroke="{TemplateBinding BorderBrush}"
                           StrokeThickness="1" />
                <Rectangle x:Name="InnerBorder"
                           Margin="2" />
                <DockPanel>
                    <ContentPresenter x:Name="Icon"
                                      Margin="4,0,6,0"
                                      VerticalAlignment="Center"
                                      ContentSource="Icon"
                                      SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                    <Path x:Name="GlyphPanel"
                          Margin="7,0,0,0"
                          VerticalAlignment="Center"
                          Data="{StaticResource Checkmark}"
                          Fill="{TemplateBinding Foreground}"
                          FlowDirection="LeftToRight"
                          Visibility="Collapsed" />
                    <ContentPresenter Margin="{TemplateBinding Padding}"
                                      ContentSource="Header"
                                      RecognizesAccessKey="True"
                                      SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                </DockPanel>
            </Grid>
            <ControlTemplate.Triggers>
                <Trigger Property="Icon"
                         Value="{x:Null}">
                    <Setter TargetName="Icon"
                            Property="Visibility"
                            Value="Collapsed" />
                </Trigger>
                <Trigger Property="IsChecked"
                         Value="true">
                    <Setter TargetName="GlyphPanel"
                            Property="Visibility"
                            Value="Visible" />
                    <Setter TargetName="Icon"
                            Property="Visibility"
                            Value="Collapsed" />
                </Trigger>
                <Trigger Property="IsHighlighted"
                         Value="true">
                    <Setter TargetName="Bg"
                            Property="Stroke"
                            Value="#90717070" />
                    <Setter TargetName="OuterBorder"
                            Property="Stroke"
                            Value="#50FFFFFF" />
                    <Setter TargetName="InnerBorder"
                            Property="Stroke"
                            Value="#50FFFFFF" />
                </Trigger>
                <Trigger Property="IsKeyboardFocused"
                         Value="true">
                    <Setter TargetName="Bg"
                            Property="Stroke"
                            Value="#E0717070" />
                    <Setter TargetName="Bg"
                            Property="Fill"
                            Value="{StaticResource MenuItemPressedFill}" />
                    <Setter TargetName="InnerBorder"
                            Property="Stroke"
                            Value="#50747272" />
                </Trigger>
                <Trigger Property="IsEnabled"
                         Value="false">
                    <Setter Property="Foreground"
                            Value="#FF9A9A9A" />
                    <Setter TargetName="GlyphPanel"
                            Property="Fill"
                            Value="#848589" />
                </Trigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>
        <Geometry x:Key="RightArrow">M 0,0 L 4,3.5 L 0,7 Z</Geometry>
        <ControlTemplate x:Key="{ComponentResourceKey ResourceId=SubmenuHeaderTemplateKey, TypeInTargetAssembly={x:Type MenuItem}}"
                         TargetType="{x:Type MenuItem}">
            <Grid SnapsToDevicePixels="true">
                <Rectangle x:Name="Bg"
                           Fill="{TemplateBinding Background}"
                           RadiusX="2"
                           RadiusY="2"
                           Stroke="{TemplateBinding BorderBrush}"
                           StrokeThickness="1" />
                <Rectangle x:Name="InnerBorder"
                           Margin="1"
                           RadiusX="2"
                           RadiusY="2"
                           Stroke="Transparent"
                           StrokeThickness="1" />
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"
                                          MinWidth="24"
                                          SharedSizeGroup="MenuItemIconColumnGroup" />
                        <ColumnDefinition Width="4" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="37" />
                        <ColumnDefinition Width="Auto"
                                          SharedSizeGroup="MenuItemIGTColumnGroup" />
                        <ColumnDefinition Width="17" />
                    </Grid.ColumnDefinitions>
                    <ContentPresenter x:Name="Icon"
                                      Margin="1"
                                      VerticalAlignment="Center"
                                      ContentSource="Icon"
                                      SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                    <Border x:Name="GlyphPanel"
                            Width="22"
                            Height="22"
                            Margin="1"
                            Background="#E6EFF4"
                            BorderBrush="#CDD3E6"
                            BorderThickness="1"
                            CornerRadius="3"
                            Visibility="Hidden">
                        <Path x:Name="Glyph"
                              Width="9"
                              Height="11"
                              Data="{StaticResource Checkmark}"
                              Fill="#0C12A1"
                              FlowDirection="LeftToRight" />
                    </Border>
                    <ContentPresenter Grid.Column="2"
                                      Margin="{TemplateBinding Padding}"
                                      ContentSource="Header"
                                      RecognizesAccessKey="True"
                                      SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                    <TextBlock Grid.Column="4"
                               Margin="{TemplateBinding Padding}"
                               Text="{TemplateBinding InputGestureText}"
                               Visibility="Collapsed" />
                    <Path Grid.Column="5"
                          Margin="4,0,0,0"
                          VerticalAlignment="Center"
                          Data="{StaticResource RightArrow}"
                          Fill="{TemplateBinding Foreground}" />
                </Grid>
                <Popup x:Name="PART_Popup"
                       AllowsTransparency="true"
                       Focusable="false"
                       HorizontalOffset="-2"
                       IsOpen="{Binding IsSubmenuOpen,
                                        RelativeSource={RelativeSource TemplatedParent}}"
                       Placement="Right"
                       PopupAnimation="{DynamicResource {x:Static SystemParameters.MenuPopupAnimationKey}}"
                       VerticalOffset="-3">
                    <Microsoft_Windows_Themes:SystemDropShadowChrome x:Name="Shdw"
                                                                     Color="Transparent">
                        <ContentControl x:Name="SubMenuBorder"
                                        IsTabStop="false"
                                        Template="{DynamicResource {ComponentResourceKey ResourceId=SubmenuContent,
                                                                                         TypeInTargetAssembly={x:Type FrameworkElement}}}">
                            <ScrollViewer x:Name="SubMenuScrollViewer"
                                          CanContentScroll="true"
                                          Style="{DynamicResource {ComponentResourceKey ResourceId=MenuScrollViewer,
                                                                                        TypeInTargetAssembly={x:Type FrameworkElement}}}">
                                <Grid RenderOptions.ClearTypeHint="Enabled">
                                    <Canvas Width="0"
                                            Height="0"
                                            HorizontalAlignment="Left"
                                            VerticalAlignment="Top">
                                        <Rectangle Width="{Binding ActualWidth,
                                                                   ElementName=SubMenuBorder}"
                                                   Height="{Binding ActualHeight,
                                                                    ElementName=SubMenuBorder}"
                                                   Fill="{StaticResource SubMenuBackgroundBrush}" />
                                    </Canvas>
                                    <ItemsPresenter x:Name="ItemsPresenter"
                                                    Margin="-1"
                                                    Grid.IsSharedSizeScope="true"
                                                    KeyboardNavigation.DirectionalNavigation="Cycle"
                                                    KeyboardNavigation.TabNavigation="Cycle"
                                                    SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                                </Grid>
                            </ScrollViewer>
                        </ContentControl>
                    </Microsoft_Windows_Themes:SystemDropShadowChrome>
                </Popup>
            </Grid>
            <ControlTemplate.Triggers>
                <Trigger Property="IsSuspendingPopupAnimation"
                         Value="true">
                    <Setter TargetName="PART_Popup"
                            Property="PopupAnimation"
                            Value="None" />
                </Trigger>
                <Trigger Property="IsHighlighted"
                         Value="true">
                    <Setter TargetName="InnerBorder"
                            Property="Stroke"
                            Value="#D1DBF4FF" />
                </Trigger>
                <Trigger Property="Icon"
                         Value="{x:Null}">
                    <Setter TargetName="Icon"
                            Property="Visibility"
                            Value="Collapsed" />
                </Trigger>
                <Trigger Property="IsChecked"
                         Value="true">
                    <Setter TargetName="GlyphPanel"
                            Property="Visibility"
                            Value="Visible" />
                    <Setter TargetName="Icon"
                            Property="Visibility"
                            Value="Collapsed" />
                </Trigger>
                <Trigger SourceName="PART_Popup"
                         Property="HasDropShadow"
                         Value="true">
                    <Setter TargetName="Shdw"
                            Property="Margin"
                            Value="0,0,5,5" />
                    <Setter TargetName="Shdw"
                            Property="Color"
                            Value="#71000000" />
                </Trigger>
                <Trigger Property="IsHighlighted"
                         Value="true">
                    <Setter TargetName="Bg"
                            Property="Fill"
                            Value="{StaticResource MenuItemSelectionFill}" />
                    <Setter TargetName="Bg"
                            Property="Stroke"
                            Value="#8571CBF1" />
                </Trigger>
                <Trigger Property="IsEnabled"
                         Value="false">
                    <Setter Property="Foreground"
                            Value="#FF9A9A9A" />
                    <Setter TargetName="GlyphPanel"
                            Property="Background"
                            Value="#EEE9E9" />
                    <Setter TargetName="GlyphPanel"
                            Property="BorderBrush"
                            Value="#DBD6D6" />
                    <Setter TargetName="Glyph"
                            Property="Fill"
                            Value="#848589" />
                </Trigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>
        <Style x:Key="MenuItemStyle1"
               TargetType="{x:Type MenuItem}">
            <Setter Property="HorizontalContentAlignment"
                    Value="{Binding HorizontalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}" />
            <Setter Property="VerticalContentAlignment"
                    Value="{Binding VerticalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}" />
            <Setter Property="Background"
                    Value="Transparent" />
            <Setter Property="ScrollViewer.PanningMode"
                    Value="Both" />
            <Setter Property="Stylus.IsFlicksEnabled"
                    Value="False" />
            <Setter Property="Template"
                    Value="{DynamicResource {ComponentResourceKey ResourceId=SubmenuItemTemplateKey, TypeInTargetAssembly={x:Type MenuItem}}}" />
            <Style.Triggers>
                <Trigger Property="Role"
                         Value="TopLevelHeader">
                    <Setter Property="Padding"
                            Value="7,2,8,3" />
                    <Setter Property="Template"
                            Value="{DynamicResource {ComponentResourceKey ResourceId=TopLevelHeaderTemplateKey, TypeInTargetAssembly={x:Type MenuItem}}}" />
                </Trigger>
                <Trigger Property="Role"
                         Value="TopLevelItem">
                    <Setter Property="Padding"
                            Value="7,2,8,3" />
                    <Setter Property="Template"
                            Value="{DynamicResource {ComponentResourceKey ResourceId=TopLevelItemTemplateKey, TypeInTargetAssembly={x:Type MenuItem}}}" />
                </Trigger>
                <Trigger Property="Role"
                         Value="SubmenuHeader">
                    <Setter Property="Padding"
                            Value="2,3,2,3" />
                    <Setter Property="Template"
                            Value="{DynamicResource {ComponentResourceKey ResourceId=SubmenuHeaderTemplateKey, TypeInTargetAssembly={x:Type MenuItem}}}" />
                </Trigger>
                <Trigger Property="Role"
                         Value="SubmenuItem">
                    <Setter Property="Padding"
                            Value="2,3,2,3" />
                </Trigger>
            </Style.Triggers>
        </Style>

        <!--  SrollViewer  -->

        <ControlTemplate x:Key="ScrollViewerControlTemplate1"
                         TargetType="{x:Type ScrollViewer}">
            <Grid x:Name="Grid"
                  Background="{TemplateBinding Background}">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>
                <ScrollContentPresenter x:Name="PART_ScrollContentPresenter"
                                        Grid.Row="0"
                                        Grid.Column="0"
                                        Margin="{TemplateBinding Padding}"
                                        CanContentScroll="{TemplateBinding CanContentScroll}"
                                        CanHorizontallyScroll="False"
                                        CanVerticallyScroll="False"
                                        Content="{TemplateBinding Content}"
                                        ContentTemplate="{TemplateBinding ContentTemplate}" />
                <ScrollBar x:Name="PART_VerticalScrollBar"
                           Grid.Row="0"
                           Grid.Column="1"
                           AutomationProperties.AutomationId="VerticalScrollBar"
                           Cursor="Arrow"
                           Maximum="{TemplateBinding ScrollableHeight}"
                           Minimum="0"
                           ViewportSize="{TemplateBinding ViewportHeight}"
                           Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}"
                           Value="{Binding VerticalOffset,
                                           Mode=OneWay,
                                           RelativeSource={RelativeSource TemplatedParent}}" />
                <ScrollBar x:Name="PART_HorizontalScrollBar"
                           Grid.Row="1"
                           Grid.Column="0"
                           AutomationProperties.AutomationId="HorizontalScrollBar"
                           Cursor="Arrow"
                           Maximum="{TemplateBinding ScrollableWidth}"
                           Minimum="0"
                           Orientation="Horizontal"
                           ViewportSize="{TemplateBinding ViewportWidth}"
                           Visibility="{TemplateBinding ComputedHorizontalScrollBarVisibility}"
                           Value="{Binding HorizontalOffset,
                                           Mode=OneWay,
                                           RelativeSource={RelativeSource TemplatedParent}}" />
                <Rectangle x:Name="Corner"
                           Grid.Row="1"
                           Grid.Column="1"
                           Fill="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" />
            </Grid>
        </ControlTemplate>

        <!--  TabControl  -->

        <SolidColorBrush x:Key="TabControlNormalBorderBrush"
                         Color="#8C8E94" />
        <Style x:Key="TabControlStyle1"
               TargetType="{x:Type TabControl}">
            <Setter Property="Foreground"
                    Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
            <Setter Property="Padding"
                    Value="4,4,4,4" />
            <Setter Property="BorderThickness"
                    Value="1" />
            <Setter Property="BorderBrush"
                    Value="{StaticResource TabControlNormalBorderBrush}" />
            <Setter Property="Background"
                    Value="#F9F9F9" />
            <Setter Property="HorizontalContentAlignment"
                    Value="Center" />
            <Setter Property="VerticalContentAlignment"
                    Value="Center" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type TabControl}">
                        <Grid ClipToBounds="true"
                              KeyboardNavigation.TabNavigation="Local"
                              SnapsToDevicePixels="true">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition x:Name="ColumnDefinition0" />
                                <ColumnDefinition x:Name="ColumnDefinition1"
                                                  Width="0" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition x:Name="RowDefinition0"
                                               Height="Auto" />
                                <RowDefinition x:Name="RowDefinition1"
                                               Height="*" />
                            </Grid.RowDefinitions>
                            <TabPanel x:Name="HeaderPanel"
                                      Grid.Row="0"
                                      Grid.Column="0"
                                      Margin="2,2,2,0"
                                      Panel.ZIndex="1"
                                      IsItemsHost="true"
                                      KeyboardNavigation.TabIndex="1" />
                            <Border x:Name="ContentPanel"
                                    Grid.Row="1"
                                    Grid.Column="0"
                                    Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    KeyboardNavigation.DirectionalNavigation="Contained"
                                    KeyboardNavigation.TabIndex="2"
                                    KeyboardNavigation.TabNavigation="Local">
                                <ContentPresenter x:Name="PART_SelectedContentHost"
                                                  Margin="{TemplateBinding Padding}"
                                                  ContentSource="SelectedContent"
                                                  SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                            </Border>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="TabStripPlacement"
                                     Value="Bottom">
                                <Setter TargetName="HeaderPanel"
                                        Property="Grid.Row"
                                        Value="1" />
                                <Setter TargetName="ContentPanel"
                                        Property="Grid.Row"
                                        Value="0" />
                                <Setter TargetName="RowDefinition0"
                                        Property="Height"
                                        Value="*" />
                                <Setter TargetName="RowDefinition1"
                                        Property="Height"
                                        Value="Auto" />
                                <Setter TargetName="HeaderPanel"
                                        Property="Margin"
                                        Value="2,0,2,2" />
                            </Trigger>
                            <Trigger Property="TabStripPlacement"
                                     Value="Left">
                                <Setter TargetName="HeaderPanel"
                                        Property="Grid.Row"
                                        Value="0" />
                                <Setter TargetName="ContentPanel"
                                        Property="Grid.Row"
                                        Value="0" />
                                <Setter TargetName="HeaderPanel"
                                        Property="Grid.Column"
                                        Value="0" />
                                <Setter TargetName="ContentPanel"
                                        Property="Grid.Column"
                                        Value="1" />
                                <Setter TargetName="ColumnDefinition0"
                                        Property="Width"
                                        Value="Auto" />
                                <Setter TargetName="ColumnDefinition1"
                                        Property="Width"
                                        Value="*" />
                                <Setter TargetName="RowDefinition0"
                                        Property="Height"
                                        Value="*" />
                                <Setter TargetName="RowDefinition1"
                                        Property="Height"
                                        Value="0" />
                                <Setter TargetName="HeaderPanel"
                                        Property="Margin"
                                        Value="2,2,0,2" />
                            </Trigger>
                            <Trigger Property="TabStripPlacement"
                                     Value="Right">
                                <Setter TargetName="HeaderPanel"
                                        Property="Grid.Row"
                                        Value="0" />
                                <Setter TargetName="ContentPanel"
                                        Property="Grid.Row"
                                        Value="0" />
                                <Setter TargetName="HeaderPanel"
                                        Property="Grid.Column"
                                        Value="1" />
                                <Setter TargetName="ContentPanel"
                                        Property="Grid.Column"
                                        Value="0" />
                                <Setter TargetName="ColumnDefinition0"
                                        Property="Width"
                                        Value="*" />
                                <Setter TargetName="ColumnDefinition1"
                                        Property="Width"
                                        Value="Auto" />
                                <Setter TargetName="RowDefinition0"
                                        Property="Height"
                                        Value="*" />
                                <Setter TargetName="RowDefinition1"
                                        Property="Height"
                                        Value="0" />
                                <Setter TargetName="HeaderPanel"
                                        Property="Margin"
                                        Value="0,2,2,2" />
                            </Trigger>
                            <Trigger Property="IsEnabled"
                                     Value="false">
                                <Setter Property="Foreground"
                                        Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!--  ComboBox  -->

        <Style x:Key="ComboBoxFocusVisual">

            <Setter Property="Control.Template">
                <Setter.Value>
                    <ControlTemplate>
                        <Rectangle Margin="4,4,21,4"
                                   SnapsToDevicePixels="true"
                                   Stroke="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                                   StrokeDashArray="1 2"
                                   StrokeThickness="1" />
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Geometry x:Key="DownArrowGeometry">M 0 0 L 3.5 4 L 7 0 Z</Geometry>
        <Style x:Key="ComboBoxReadonlyToggleButton"
               TargetType="{x:Type ToggleButton}">
            <Setter Property="OverridesDefaultStyle"
                    Value="true" />
            <Setter Property="IsTabStop"
                    Value="false" />
            <Setter Property="Focusable"
                    Value="false" />
            <Setter Property="ClickMode"
                    Value="Press" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ToggleButton}">
                        <Microsoft_Windows_Themes:ButtonChrome x:Name="Chrome"
                                                               Background="{TemplateBinding Background}"
                                                               BorderBrush="{TemplateBinding BorderBrush}"
                                                               RenderMouseOver="{TemplateBinding IsMouseOver}"
                                                               RenderPressed="{TemplateBinding IsPressed}"
                                                               SnapsToDevicePixels="true">
                            <Grid Width="{DynamicResource {x:Static SystemParameters.VerticalScrollBarWidthKey}}"
                                  HorizontalAlignment="Right">
                                <Path x:Name="Arrow"
                                      Margin="3,1,0,0"
                                      HorizontalAlignment="Center"
                                      VerticalAlignment="Center"
                                      Data="{StaticResource DownArrowGeometry}"
                                      Fill="Black" />
                            </Grid>
                        </Microsoft_Windows_Themes:ButtonChrome>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked"
                                     Value="true">
                                <Setter TargetName="Chrome"
                                        Property="RenderPressed"
                                        Value="true" />
                            </Trigger>
                            <Trigger Property="IsEnabled"
                                     Value="false">
                                <Setter TargetName="Arrow"
                                        Property="Fill"
                                        Value="#AFAFAF" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="ComboBoxEditableTextBox"
               TargetType="{x:Type TextBox}">
            <Setter Property="OverridesDefaultStyle"
                    Value="true" />
            <Setter Property="AllowDrop"
                    Value="true" />
            <Setter Property="MinWidth"
                    Value="0" />
            <Setter Property="MinHeight"
                    Value="0" />
            <Setter Property="FocusVisualStyle"
                    Value="{x:Null}" />
            <Setter Property="ScrollViewer.PanningMode"
                    Value="VerticalFirst" />
            <Setter Property="Stylus.IsFlicksEnabled"
                    Value="False" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type TextBox}">
                        <ScrollViewer x:Name="PART_ContentHost"
                                      Background="Transparent"
                                      Focusable="false"
                                      HorizontalScrollBarVisibility="Hidden"
                                      VerticalScrollBarVisibility="Hidden" />
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="ComboBoxToggleButton"
               TargetType="{x:Type ToggleButton}">
            <Setter Property="OverridesDefaultStyle"
                    Value="true" />
            <Setter Property="IsTabStop"
                    Value="false" />
            <Setter Property="Focusable"
                    Value="false" />
            <Setter Property="ClickMode"
                    Value="Press" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ToggleButton}">
                        <Microsoft_Windows_Themes:ButtonChrome x:Name="Chrome"
                                                               Width="{DynamicResource {x:Static SystemParameters.VerticalScrollBarWidthKey}}"
                                                               Background="{TemplateBinding Background}"
                                                               BorderBrush="{TemplateBinding BorderBrush}"
                                                               RenderMouseOver="{TemplateBinding IsMouseOver}"
                                                               RenderPressed="{TemplateBinding IsPressed}"
                                                               RoundCorners="false"
                                                               SnapsToDevicePixels="true">
                            <Path x:Name="Arrow"
                                  Margin="0,1,0,0"
                                  HorizontalAlignment="Center"
                                  VerticalAlignment="Center"
                                  Data="{StaticResource DownArrowGeometry}"
                                  Fill="Black" />
                        </Microsoft_Windows_Themes:ButtonChrome>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked"
                                     Value="true">
                                <Setter TargetName="Chrome"
                                        Property="RenderPressed"
                                        Value="true" />
                            </Trigger>
                            <Trigger Property="IsEnabled"
                                     Value="false">
                                <Setter TargetName="Arrow"
                                        Property="Fill"
                                        Value="#AFAFAF" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <ControlTemplate x:Key="ComboBoxEditableTemplate"
                         TargetType="{x:Type ComboBox}">
            <Grid x:Name="Placement"
                  SnapsToDevicePixels="true">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <Popup x:Name="PART_Popup"
                       Grid.ColumnSpan="2"
                       AllowsTransparency="true"
                       IsOpen="{Binding IsDropDownOpen,
                                        RelativeSource={RelativeSource TemplatedParent}}"
                       Placement="Bottom"
                       PopupAnimation="{DynamicResource {x:Static SystemParameters.ComboBoxPopupAnimationKey}}">
                    <Microsoft_Windows_Themes:SystemDropShadowChrome x:Name="Shdw"
                                                                     MinWidth="{Binding ActualWidth,
                                                                                        ElementName=Placement}"
                                                                     MaxHeight="{TemplateBinding MaxDropDownHeight}"
                                                                     Color="Transparent">
                        <Border x:Name="DropDownBorder"
                                Background="{DynamicResource {x:Static SystemColors.WindowBrushKey}}"
                                BorderBrush="{DynamicResource {x:Static SystemColors.WindowFrameBrushKey}}"
                                BorderThickness="1">
                            <ScrollViewer x:Name="DropDownScrollViewer">
                                <Grid RenderOptions.ClearTypeHint="Enabled">
                                    <Canvas Width="0"
                                            Height="0"
                                            HorizontalAlignment="Left"
                                            VerticalAlignment="Top">
                                        <Rectangle x:Name="OpaqueRect"
                                                   Width="{Binding ActualWidth,
                                                                   ElementName=DropDownBorder}"
                                                   Height="{Binding ActualHeight,
                                                                    ElementName=DropDownBorder}"
                                                   Fill="{Binding Background,
                                                                  ElementName=DropDownBorder}" />
                                    </Canvas>
                                    <ItemsPresenter x:Name="ItemsPresenter"
                                                    KeyboardNavigation.DirectionalNavigation="Contained"
                                                    SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                                </Grid>
                            </ScrollViewer>
                        </Border>
                    </Microsoft_Windows_Themes:SystemDropShadowChrome>
                </Popup>
                <Microsoft_Windows_Themes:ListBoxChrome x:Name="Border"
                                                        Grid.ColumnSpan="2"
                                                        Background="{TemplateBinding Background}"
                                                        BorderBrush="{TemplateBinding BorderBrush}"
                                                        BorderThickness="{TemplateBinding BorderThickness}"
                                                        RenderFocused="{TemplateBinding IsKeyboardFocusWithin}"
                                                        RenderMouseOver="{TemplateBinding IsMouseOver}" />
                <TextBox x:Name="PART_EditableTextBox"
                         Margin="{TemplateBinding Padding}"
                         HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}"
                         VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}"
                         IsReadOnly="{Binding IsReadOnly,
                                              RelativeSource={RelativeSource TemplatedParent}}"
                         Style="{StaticResource ComboBoxEditableTextBox}" />
                <ToggleButton Grid.Column="1"
                              IsChecked="{Binding IsDropDownOpen,
                                                  Mode=TwoWay,
                                                  RelativeSource={RelativeSource TemplatedParent}}"
                              Style="{StaticResource ComboBoxToggleButton}" />
            </Grid>
            <ControlTemplate.Triggers>
                <Trigger Property="IsKeyboardFocusWithin"
                         Value="true">
                    <Setter Property="Foreground"
                            Value="Black" />
                </Trigger>
                <Trigger Property="IsDropDownOpen"
                         Value="true">
                    <Setter TargetName="Border"
                            Property="RenderFocused"
                            Value="true" />
                </Trigger>
                <Trigger Property="HasItems"
                         Value="false">
                    <Setter TargetName="DropDownBorder"
                            Property="Height"
                            Value="95" />
                </Trigger>
                <Trigger Property="IsEnabled"
                         Value="false">
                    <Setter Property="Foreground"
                            Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                    <Setter Property="Background"
                            Value="#FFF4F4F4" />
                </Trigger>
                <Trigger Property="IsGrouping"
                         Value="true">
                    <Setter Property="ScrollViewer.CanContentScroll"
                            Value="false" />
                </Trigger>
                <Trigger SourceName="PART_Popup"
                         Property="HasDropShadow"
                         Value="true">
                    <Setter TargetName="Shdw"
                            Property="Margin"
                            Value="0,0,5,5" />
                    <Setter TargetName="Shdw"
                            Property="Color"
                            Value="#71000000" />
                </Trigger>
                <Trigger SourceName="DropDownScrollViewer"
                         Property="ScrollViewer.CanContentScroll"
                         Value="false">
                    <Setter TargetName="OpaqueRect"
                            Property="Canvas.Top"
                            Value="{Binding VerticalOffset, ElementName=DropDownScrollViewer}" />
                    <Setter TargetName="OpaqueRect"
                            Property="Canvas.Left"
                            Value="{Binding HorizontalOffset, ElementName=DropDownScrollViewer}" />
                </Trigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>
        <Style x:Key="ComboBoxStyle1"
               TargetType="{x:Type ComboBox}">
            <Setter Property="FocusVisualStyle"
                    Value="{StaticResource ComboBoxFocusVisual}" />
            <Setter Property="Foreground"
                    Value="{DynamicResource {x:Static SystemColors.WindowTextBrushKey}}" />
            <Setter Property="Background"
                    Value="{StaticResource ButtonNormalBackground}" />
            <Setter Property="BorderBrush"
                    Value="{StaticResource ButtonNormalBorder}" />
            <Setter Property="BorderThickness"
                    Value="1" />
            <Setter Property="ScrollViewer.HorizontalScrollBarVisibility"
                    Value="Auto" />
            <Setter Property="ScrollViewer.VerticalScrollBarVisibility"
                    Value="Auto" />
            <Setter Property="Padding"
                    Value="4,3" />
            <Setter Property="ScrollViewer.CanContentScroll"
                    Value="true" />
            <Setter Property="ScrollViewer.PanningMode"
                    Value="Both" />
            <Setter Property="Stylus.IsFlicksEnabled"
                    Value="False" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ComboBox}">
                        <Grid x:Name="MainGrid"
                              SnapsToDevicePixels="true">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="0"
                                                  MinWidth="{DynamicResource {x:Static SystemParameters.VerticalScrollBarWidthKey}}" />
                            </Grid.ColumnDefinitions>
                            <Popup x:Name="PART_Popup"
                                   Grid.ColumnSpan="2"
                                   Margin="1"
                                   AllowsTransparency="true"
                                   IsOpen="{Binding IsDropDownOpen,
                                                    RelativeSource={RelativeSource TemplatedParent}}"
                                   Placement="Bottom"
                                   PopupAnimation="{DynamicResource {x:Static SystemParameters.ComboBoxPopupAnimationKey}}">
                                <Microsoft_Windows_Themes:SystemDropShadowChrome x:Name="Shdw"
                                                                                 MinWidth="{Binding ActualWidth,
                                                                                                    ElementName=MainGrid}"
                                                                                 MaxHeight="{TemplateBinding MaxDropDownHeight}"
                                                                                 Color="Transparent">
                                    <Border x:Name="DropDownBorder"
                                            Background="{DynamicResource {x:Static SystemColors.WindowBrushKey}}"
                                            BorderBrush="{DynamicResource {x:Static SystemColors.WindowFrameBrushKey}}"
                                            BorderThickness="1">
                                        <ScrollViewer x:Name="DropDownScrollViewer">
                                            <Grid RenderOptions.ClearTypeHint="Enabled">
                                                <Canvas Width="0"
                                                        Height="0"
                                                        HorizontalAlignment="Left"
                                                        VerticalAlignment="Top">
                                                    <Rectangle x:Name="OpaqueRect"
                                                               Width="{Binding ActualWidth,
                                                                               ElementName=DropDownBorder}"
                                                               Height="{Binding ActualHeight,
                                                                                ElementName=DropDownBorder}"
                                                               Fill="{Binding Background,
                                                                              ElementName=DropDownBorder}" />
                                                </Canvas>
                                                <ItemsPresenter x:Name="ItemsPresenter"
                                                                KeyboardNavigation.DirectionalNavigation="Contained"
                                                                SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                                            </Grid>
                                        </ScrollViewer>
                                    </Border>
                                </Microsoft_Windows_Themes:SystemDropShadowChrome>
                            </Popup>
                            <ToggleButton Grid.ColumnSpan="2"
                                          Background="{TemplateBinding Background}"
                                          BorderBrush="{TemplateBinding BorderBrush}"
                                          IsChecked="{Binding IsDropDownOpen,
                                                              Mode=TwoWay,
                                                              RelativeSource={RelativeSource TemplatedParent}}"
                                          Style="{StaticResource ComboBoxReadonlyToggleButton}" />
                            <ContentPresenter Margin="{TemplateBinding Padding}"
                                              HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                              VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                              Content="{TemplateBinding SelectionBoxItem}"
                                              ContentStringFormat="{TemplateBinding SelectionBoxItemStringFormat}"
                                              ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                                              ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}"
                                              IsHitTestVisible="false"
                                              SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger SourceName="PART_Popup"
                                     Property="HasDropShadow"
                                     Value="true">
                                <Setter TargetName="Shdw"
                                        Property="Margin"
                                        Value="0,0,5,5" />
                                <Setter TargetName="Shdw"
                                        Property="Color"
                                        Value="#71000000" />
                            </Trigger>
                            <Trigger Property="HasItems"
                                     Value="false">
                                <Setter TargetName="DropDownBorder"
                                        Property="Height"
                                        Value="95" />
                            </Trigger>
                            <Trigger Property="IsEnabled"
                                     Value="false">
                                <Setter Property="Foreground"
                                        Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                                <Setter Property="Background"
                                        Value="#FFF4F4F4" />
                            </Trigger>
                            <Trigger Property="IsGrouping"
                                     Value="true">
                                <Setter Property="ScrollViewer.CanContentScroll"
                                        Value="false" />
                            </Trigger>
                            <Trigger SourceName="DropDownScrollViewer"
                                     Property="ScrollViewer.CanContentScroll"
                                     Value="false">
                                <Setter TargetName="OpaqueRect"
                                        Property="Canvas.Top"
                                        Value="{Binding VerticalOffset, ElementName=DropDownScrollViewer}" />
                                <Setter TargetName="OpaqueRect"
                                        Property="Canvas.Left"
                                        Value="{Binding HorizontalOffset, ElementName=DropDownScrollViewer}" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsEditable"
                         Value="true">
                    <Setter Property="BorderBrush"
                            Value="{StaticResource TextBoxBorder}" />
                    <Setter Property="Background"
                            Value="{DynamicResource {x:Static SystemColors.WindowBrushKey}}" />
                    <Setter Property="IsTabStop"
                            Value="false" />
                    <Setter Property="Padding"
                            Value="3" />
                    <Setter Property="Template"
                            Value="{StaticResource ComboBoxEditableTemplate}" />
                </Trigger>
            </Style.Triggers>
        </Style>

        <!--  ListBox  -->

        <SolidColorBrush x:Key="ListBorder"
                         Color="#828790" />
        <Style x:Key="ListBoxStyle1"
               TargetType="{x:Type ListBox}">
            <Setter Property="Background"
                    Value="{DynamicResource {x:Static SystemColors.WindowBrushKey}}" />
            <Setter Property="BorderBrush"
                    Value="{StaticResource ListBorder}" />
            <Setter Property="BorderThickness"
                    Value="1" />
            <Setter Property="Foreground"
                    Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
            <Setter Property="ScrollViewer.HorizontalScrollBarVisibility"
                    Value="Auto" />
            <Setter Property="ScrollViewer.VerticalScrollBarVisibility"
                    Value="Auto" />
            <Setter Property="ScrollViewer.CanContentScroll"
                    Value="true" />
            <Setter Property="ScrollViewer.PanningMode"
                    Value="Both" />
            <Setter Property="Stylus.IsFlicksEnabled"
                    Value="False" />
            <Setter Property="VerticalContentAlignment"
                    Value="Center" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ListBox}">
                        <Border x:Name="Bd"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                Padding="1"
                                SnapsToDevicePixels="true">
                            <ScrollViewer Focusable="false"
                                          Padding="{TemplateBinding Padding}">
                                <ItemsPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                            </ScrollViewer>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsEnabled"
                                     Value="false">
                                <Setter TargetName="Bd"
                                        Property="Background"
                                        Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" />
                            </Trigger>
                            <Trigger Property="IsGrouping"
                                     Value="true">
                                <Setter Property="ScrollViewer.CanContentScroll"
                                        Value="false" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="{ComponentResourceKey ResourceId=DataGridSelectAllButtonStyle, TypeInTargetAssembly={x:Type DataGrid}}"
               TargetType="{x:Type Button}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Button}">
                        <Grid>
                            <Rectangle x:Name="Border"
                                       Fill="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"
                                       SnapsToDevicePixels="True" />
                            <Polygon x:Name="Arrow"
                                     Margin="8,8,3,3"
                                     HorizontalAlignment="Right"
                                     VerticalAlignment="Bottom"
                                     Fill="Black"
                                     Opacity="0.15"
                                     Points="0,10 10,10 10,0"
                                     Stretch="Uniform" />
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver"
                                     Value="True">
                                <Setter TargetName="Border"
                                        Property="Stroke"
                                        Value="{DynamicResource {x:Static SystemColors.ControlDarkBrushKey}}" />
                            </Trigger>
                            <Trigger Property="IsPressed"
                                     Value="True">
                                <Setter TargetName="Border"
                                        Property="Fill"
                                        Value="{DynamicResource {x:Static SystemColors.ControlDarkBrushKey}}" />
                            </Trigger>
                            <Trigger Property="IsEnabled"
                                     Value="False">
                                <Setter TargetName="Arrow"
                                        Property="Visibility"
                                        Value="Collapsed" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!--  DataGrid  -->

        <Style x:Key="DataGridStyle1"
               TargetType="{x:Type DataGrid}">
            <Setter Property="Background"
                    Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" />
            <Setter Property="Foreground"
                    Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
            <Setter Property="BorderBrush"
                    Value="#FF688CAF" />
            <Setter Property="BorderThickness"
                    Value="1" />
            <Setter Property="RowDetailsVisibilityMode"
                    Value="VisibleWhenSelected" />
            <Setter Property="ScrollViewer.CanContentScroll"
                    Value="true" />
            <Setter Property="ScrollViewer.PanningMode"
                    Value="Both" />
            <Setter Property="Stylus.IsFlicksEnabled"
                    Value="False" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type DataGrid}">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                Padding="{TemplateBinding Padding}"
                                SnapsToDevicePixels="True">
                            <ScrollViewer x:Name="DG_ScrollViewer"
                                          Focusable="false">
                                <ScrollViewer.Template>
                                    <ControlTemplate TargetType="{x:Type ScrollViewer}">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="*" />
                                                <RowDefinition Height="Auto" />
                                            </Grid.RowDefinitions>
                                            <Button Width="{Binding CellsPanelHorizontalOffset,
                                                                    RelativeSource={RelativeSource AncestorType={x:Type DataGrid}}}"
                                                    Command="{x:Static DataGrid.SelectAllCommand}"
                                                    Focusable="false"
                                                    Style="{DynamicResource {ComponentResourceKey ResourceId=DataGridSelectAllButtonStyle,
                                                                                                  TypeInTargetAssembly={x:Type DataGrid}}}"
                                                    Visibility="{Binding HeadersVisibility,
                                                                         ConverterParameter={x:Static DataGridHeadersVisibility.All},
                                                                         Converter={x:Static DataGrid.HeadersVisibilityConverter},
                                                                         RelativeSource={RelativeSource AncestorType={x:Type DataGrid}}}" />
                                            <DataGridColumnHeadersPresenter x:Name="PART_ColumnHeadersPresenter"
                                                                            Grid.Column="1"
                                                                            Visibility="{Binding HeadersVisibility,
                                                                                                 ConverterParameter={x:Static DataGridHeadersVisibility.Column},
                                                                                                 Converter={x:Static DataGrid.HeadersVisibilityConverter},
                                                                                                 RelativeSource={RelativeSource AncestorType={x:Type DataGrid}}}" />
                                            <ScrollContentPresenter x:Name="PART_ScrollContentPresenter"
                                                                    Grid.Row="1"
                                                                    Grid.ColumnSpan="2"
                                                                    CanContentScroll="{TemplateBinding CanContentScroll}" />
                                            <ScrollBar x:Name="PART_VerticalScrollBar"
                                                       Grid.Row="1"
                                                       Grid.Column="2"
                                                       Maximum="{TemplateBinding ScrollableHeight}"
                                                       Orientation="Vertical"
                                                       ViewportSize="{TemplateBinding ViewportHeight}"
                                                       Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}"
                                                       Value="{Binding VerticalOffset,
                                                                       Mode=OneWay,
                                                                       RelativeSource={RelativeSource TemplatedParent}}" />
                                            <Grid Grid.Row="2"
                                                  Grid.Column="1">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="{Binding NonFrozenColumnsViewportHorizontalOffset, RelativeSource={RelativeSource AncestorType={x:Type DataGrid}}}" />
                                                    <ColumnDefinition Width="*" />
                                                </Grid.ColumnDefinitions>
                                                <ScrollBar x:Name="PART_HorizontalScrollBar"
                                                           Grid.Column="1"
                                                           Maximum="{TemplateBinding ScrollableWidth}"
                                                           Orientation="Horizontal"
                                                           ViewportSize="{TemplateBinding ViewportWidth}"
                                                           Visibility="{TemplateBinding ComputedHorizontalScrollBarVisibility}"
                                                           Value="{Binding HorizontalOffset,
                                                                           Mode=OneWay,
                                                                           RelativeSource={RelativeSource TemplatedParent}}" />
                                            </Grid>
                                        </Grid>
                                    </ControlTemplate>
                                </ScrollViewer.Template>
                                <ItemsPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                            </ScrollViewer>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsGrouping"
                         Value="true">
                    <Setter Property="ScrollViewer.CanContentScroll"
                            Value="false" />
                </Trigger>
            </Style.Triggers>
        </Style>

        <!--  TabItem  -->

        <Style x:Key="TabItemFocusVisual">
            <Setter Property="Control.Template">
                <Setter.Value>
                    <ControlTemplate>
                        <Rectangle Margin="3,3,3,1"
                                   SnapsToDevicePixels="true"
                                   Stroke="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                                   StrokeDashArray="1 2"
                                   StrokeThickness="1" />
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <LinearGradientBrush x:Key="TabItemHotBackground"
                             StartPoint="0,0"
                             EndPoint="0,1">
            <GradientStop Offset="0.15"
                          Color="#EAF6FD" />
            <GradientStop Offset=".5"
                          Color="#D9F0FC" />
            <GradientStop Offset=".5"
                          Color="#BEE6FD" />
            <GradientStop Offset="1"
                          Color="#A7D9F5" />
        </LinearGradientBrush>
        <SolidColorBrush x:Key="TabItemSelectedBackground"
                         Color="#F9F9F9" />
        <SolidColorBrush x:Key="TabItemHotBorderBrush"
                         Color="#3C7FB1" />
        <SolidColorBrush x:Key="TabItemDisabledBackground"
                         Color="#F4F4F4" />
        <SolidColorBrush x:Key="TabItemDisabledBorderBrush"
                         Color="#FFC9C7BA" />
        <Style x:Key="TabItemStyle1"
               TargetType="{x:Type TabItem}">
            <Setter Property="FocusVisualStyle"
                    Value="{StaticResource TabItemFocusVisual}" />
            <Setter Property="Foreground"
                    Value="Black" />
            <Setter Property="Padding"
                    Value="6,1,6,1" />
            <Setter Property="BorderBrush"
                    Value="{StaticResource TabControlNormalBorderBrush}" />
            <Setter Property="Background"
                    Value="{StaticResource ButtonNormalBackground}" />
            <Setter Property="HorizontalContentAlignment"
                    Value="Stretch" />
            <Setter Property="VerticalContentAlignment"
                    Value="Stretch" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type TabItem}">
                        <Grid SnapsToDevicePixels="true">
                            <Border x:Name="Bd"
                                    Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="1,1,1,0"
                                    Padding="{TemplateBinding Padding}">
                                <ContentPresenter x:Name="Content"
                                                  HorizontalAlignment="{Binding HorizontalContentAlignment,
                                                                                RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"
                                                  VerticalAlignment="{Binding VerticalContentAlignment,
                                                                              RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"
                                                  ContentSource="Header"
                                                  RecognizesAccessKey="True"
                                                  SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                            </Border>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver"
                                     Value="true">
                                <Setter TargetName="Bd"
                                        Property="Background"
                                        Value="{StaticResource TabItemHotBackground}" />
                            </Trigger>
                            <Trigger Property="IsSelected"
                                     Value="true">
                                <Setter Property="Panel.ZIndex"
                                        Value="1" />
                                <Setter TargetName="Bd"
                                        Property="Background"
                                        Value="{StaticResource TabItemSelectedBackground}" />
                            </Trigger>
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsSelected"
                                               Value="false" />
                                    <Condition Property="IsMouseOver"
                                               Value="true" />
                                </MultiTrigger.Conditions>
                                <Setter TargetName="Bd"
                                        Property="BorderBrush"
                                        Value="{StaticResource TabItemHotBorderBrush}" />
                            </MultiTrigger>
                            <Trigger Property="TabStripPlacement"
                                     Value="Bottom">
                                <Setter TargetName="Bd"
                                        Property="BorderThickness"
                                        Value="1,0,1,1" />
                            </Trigger>
                            <Trigger Property="TabStripPlacement"
                                     Value="Left">
                                <Setter TargetName="Bd"
                                        Property="BorderThickness"
                                        Value="1,1,0,1" />
                            </Trigger>
                            <Trigger Property="TabStripPlacement"
                                     Value="Right">
                                <Setter TargetName="Bd"
                                        Property="BorderThickness"
                                        Value="0,1,1,1" />
                            </Trigger>
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsSelected"
                                               Value="true" />
                                    <Condition Property="TabStripPlacement"
                                               Value="Top" />
                                </MultiTrigger.Conditions>
                                <Setter Property="Margin"
                                        Value="-2,-2,-2,-1" />
                                <Setter TargetName="Content"
                                        Property="Margin"
                                        Value="0,0,0,1" />
                            </MultiTrigger>
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsSelected"
                                               Value="true" />
                                    <Condition Property="TabStripPlacement"
                                               Value="Bottom" />
                                </MultiTrigger.Conditions>
                                <Setter Property="Margin"
                                        Value="-2,-1,-2,-2" />
                                <Setter TargetName="Content"
                                        Property="Margin"
                                        Value="0,1,0,0" />
                            </MultiTrigger>
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsSelected"
                                               Value="true" />
                                    <Condition Property="TabStripPlacement"
                                               Value="Left" />
                                </MultiTrigger.Conditions>
                                <Setter Property="Margin"
                                        Value="-2,-2,-1,-2" />
                                <Setter TargetName="Content"
                                        Property="Margin"
                                        Value="0,0,1,0" />
                            </MultiTrigger>
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsSelected"
                                               Value="true" />
                                    <Condition Property="TabStripPlacement"
                                               Value="Right" />
                                </MultiTrigger.Conditions>
                                <Setter Property="Margin"
                                        Value="-1,-2,-2,-2" />
                                <Setter TargetName="Content"
                                        Property="Margin"
                                        Value="1,0,0,0" />
                            </MultiTrigger>
                            <Trigger Property="IsEnabled"
                                     Value="false">
                                <Setter TargetName="Bd"
                                        Property="Background"
                                        Value="{StaticResource TabItemDisabledBackground}" />
                                <Setter TargetName="Bd"
                                        Property="BorderBrush"
                                        Value="{StaticResource TabItemDisabledBorderBrush}" />
                                <Setter Property="Foreground"
                                        Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!--  ListView + GridView  -->

        <Style x:Key="{x:Static GridView.GridViewScrollViewerStyleKey}"
               TargetType="{x:Type ScrollViewer}">
            <Setter Property="Focusable"
                    Value="false" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ScrollViewer}">
                        <Grid Background="{TemplateBinding Background}"
                              SnapsToDevicePixels="true">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <DockPanel Margin="{TemplateBinding Padding}">
                                <ScrollViewer DockPanel.Dock="Top"
                                              Focusable="false"
                                              HorizontalScrollBarVisibility="Hidden"
                                              VerticalScrollBarVisibility="Hidden">
                                    <GridViewHeaderRowPresenter Margin="2,0,2,0"
                                                                AllowsColumnReorder="{Binding TemplatedParent.View.AllowsColumnReorder,
                                                                                              RelativeSource={RelativeSource TemplatedParent}}"
                                                                ColumnHeaderContainerStyle="{Binding TemplatedParent.View.ColumnHeaderContainerStyle,
                                                                                                     RelativeSource={RelativeSource TemplatedParent}}"
                                                                ColumnHeaderContextMenu="{Binding TemplatedParent.View.ColumnHeaderContextMenu,
                                                                                                  RelativeSource={RelativeSource TemplatedParent}}"
                                                                ColumnHeaderStringFormat="{Binding TemplatedParent.View.ColumnHeaderStringFormat,
                                                                                                   RelativeSource={RelativeSource TemplatedParent}}"
                                                                ColumnHeaderTemplate="{Binding TemplatedParent.View.ColumnHeaderTemplate,
                                                                                               RelativeSource={RelativeSource TemplatedParent}}"
                                                                ColumnHeaderTemplateSelector="{Binding TemplatedParent.View.ColumnHeaderTemplateSelector,
                                                                                                       RelativeSource={RelativeSource TemplatedParent}}"
                                                                ColumnHeaderToolTip="{Binding TemplatedParent.View.ColumnHeaderToolTip,
                                                                                              RelativeSource={RelativeSource TemplatedParent}}"
                                                                Columns="{Binding TemplatedParent.View.Columns,
                                                                                  RelativeSource={RelativeSource TemplatedParent}}"
                                                                SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                                </ScrollViewer>
                                <ScrollContentPresenter x:Name="PART_ScrollContentPresenter"
                                                        CanContentScroll="{TemplateBinding CanContentScroll}"
                                                        Content="{TemplateBinding Content}"
                                                        ContentTemplate="{TemplateBinding ContentTemplate}"
                                                        KeyboardNavigation.DirectionalNavigation="Local"
                                                        SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                            </DockPanel>
                            <ScrollBar x:Name="PART_VerticalScrollBar"
                                       Grid.Column="1"
                                       Cursor="Arrow"
                                       Maximum="{TemplateBinding ScrollableHeight}"
                                       Minimum="0.0"
                                       Orientation="Vertical"
                                       ViewportSize="{TemplateBinding ViewportHeight}"
                                       Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}"
                                       Value="{Binding VerticalOffset,
                                                       Mode=OneWay,
                                                       RelativeSource={RelativeSource TemplatedParent}}" />
                            <ScrollBar x:Name="PART_HorizontalScrollBar"
                                       Grid.Row="1"
                                       Cursor="Arrow"
                                       Maximum="{TemplateBinding ScrollableWidth}"
                                       Minimum="0.0"
                                       Orientation="Horizontal"
                                       ViewportSize="{TemplateBinding ViewportWidth}"
                                       Visibility="{TemplateBinding ComputedHorizontalScrollBarVisibility}"
                                       Value="{Binding HorizontalOffset,
                                                       Mode=OneWay,
                                                       RelativeSource={RelativeSource TemplatedParent}}" />
                            <DockPanel Grid.Row="1"
                                       Grid.Column="1"
                                       Background="{Binding Background,
                                                            ElementName=PART_VerticalScrollBar}"
                                       LastChildFill="false">
                                <Rectangle Width="1"
                                           DockPanel.Dock="Left"
                                           Fill="White"
                                           Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}" />
                                <Rectangle Height="1"
                                           DockPanel.Dock="Top"
                                           Fill="White"
                                           Visibility="{TemplateBinding ComputedHorizontalScrollBarVisibility}" />
                            </DockPanel>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="ListViewStyle1"
               TargetType="{x:Type ListView}">
            <Setter Property="Background"
                    Value="{DynamicResource {x:Static SystemColors.WindowBrushKey}}" />
            <Setter Property="BorderBrush"
                    Value="{StaticResource ListBorder}" />
            <Setter Property="BorderThickness"
                    Value="1" />
            <Setter Property="Foreground"
                    Value="#FF042271" />
            <Setter Property="ScrollViewer.HorizontalScrollBarVisibility"
                    Value="Auto" />
            <Setter Property="ScrollViewer.VerticalScrollBarVisibility"
                    Value="Auto" />
            <Setter Property="ScrollViewer.CanContentScroll"
                    Value="true" />
            <Setter Property="ScrollViewer.PanningMode"
                    Value="Both" />
            <Setter Property="Stylus.IsFlicksEnabled"
                    Value="False" />
            <Setter Property="VerticalContentAlignment"
                    Value="Center" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ListView}">
                        <Microsoft_Windows_Themes:ListBoxChrome x:Name="Bd"
                                                                Background="{TemplateBinding Background}"
                                                                BorderBrush="{TemplateBinding BorderBrush}"
                                                                BorderThickness="{TemplateBinding BorderThickness}"
                                                                RenderFocused="{TemplateBinding IsKeyboardFocusWithin}"
                                                                RenderMouseOver="{TemplateBinding IsMouseOver}"
                                                                SnapsToDevicePixels="true">
                            <ScrollViewer Padding="{TemplateBinding Padding}"
                                          Style="{DynamicResource {x:Static GridView.GridViewScrollViewerStyleKey}}">
                                <ItemsPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                            </ScrollViewer>
                        </Microsoft_Windows_Themes:ListBoxChrome>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsGrouping"
                                     Value="true">
                                <Setter Property="ScrollViewer.CanContentScroll"
                                        Value="false" />
                            </Trigger>
                            <Trigger Property="IsEnabled"
                                     Value="false">
                                <Setter TargetName="Bd"
                                        Property="Background"
                                        Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!--  ListView  -->
    </Application.Resources>
</Application>